#textdomain wesnoth-rtl

[scenario]
    id=06_The_Rootless
    name= _ "The Rootless"
    map_data="{~add-ons/The_Rootless/maps/06_The_Rootless.map}"
    next_scenario=07_The_Truth
    victory_when_enemies_defeated=no

    {SCENARIO_MUSIC traveling_minstrels.ogg}
    {EXTRA_SCENARIO_MUSIC frantic-old.ogg}
    {EXTRA_SCENARIO_MUSIC legends_of_the_north.ogg}

    {DEATHS_THE_ROOTLESS}
    {STAFF_OF_HAUNTING}
    {RECALL_DISCOUNT}
    {DARK_WILL_MACRO}
    {MAIN_CHARACTERS_EVENTS}
    {RING_OF_FROST}
    {DEFAULT_SCHEDULE}

    [story]
        [part]
            music=northerners-old.ogg
            background=story-orc.jpg
            story= _ "After a long journey, the orcs finally reached a place where they could rest. They camped in the foothills by a small river and liked the place so much that they decided to spend the winter there."
        [/part]
        [part]
            background=story-orc.jpg
            story= _ "Scouts have even brought information that some warlords have abandoned their futile battles with humans and elves and have begun to retreat north. A cautious optimism began to spread among the orcs. Unfortunately, it was premature."
        [/part]
    [/story]

    {RTL_TRACK {JOURNEY_06_NEW}}

    [side]
        side=1
        controller=human
        {GOLD 400 380 360}
        {INCOME 3 2 1}
        team_name=Orcs
        user_team_name= _ "Orcs"
        {FLAG_VARIANT6 ragged}
        recruit="Orcish Archer,Goblin Spearman,Orcish Grunt,Orcish Assassin"
        type=Orcish Assassin
        id=Arshag
        shroud=yes
        fog=no
        unrenamable=yes
        facing=nw
        name= _ "Arshag"
        x,y=7,24
        [modifications]
            {TRAIT_INTELLIGENT}
        [/modifications]
        canrecruit=yes
    [/side]

    [side]
        side=2
        controller=ai
        {GOLD 180 250 270}
        {INCOME 1 2 3}
        name=Hudoc
        id=ShamanKiller
        type=Ranger
        x,y=29,25
        facing=sw
        team_name=Wesfolk
        user_team_name= _ "Wesfolk"
        color=lightblue
#ifdef EASY
        recruit="Footpad,Thug,Thief,Poacher,RTL Wesfolk Adept,Trapper"
#endif
#ifdef NORMAL
        recruit="Footpad,Thug,Thief,Poacher,RTL Wesfolk Adept,Outlaw,Bandit,Trapper"
#endif
#ifdef HARD
        recruit="Footpad,Thug,Thief,Poacher,RTL Wesfolk Adept,Outlaw,Bandit,Trapper,Rogue,RTL Wesfolk Sorcerer,Fugitive,Huntsman"
#endif
        [ai] #outlaws won't fall into the ice trap
            [avoid]
                x="27,28,29,30,31"
	            y="5-7,4-7,4-8,4-7,5-7"
            [/avoid]
        [/ai]
    [/side]

    [side]
        side=3
        controller=ai
        {GOLD 190 220 250}
        {INCOME 5 9 12}
        id=Clerila
        name="Clerila"
        gender=female
        unrenamable=yes
        facing=ne
        type=Rogue
        x,y=8,16
        team_name=Orcs
        user_team_name= _ "Clerila"
        color=lightblue
        shroud=no
        [modifications]
            {TRAIT_DEXTROUS}
            [object]
                id=clerila_lvl3
                silent=yes
                duration=forever
                [filter]
                    id=Clerila
                [/filter]
                [effect]
                    apply_to=remove_advancement
                    types=Assassin
                [/effect]
                [effect]
                    apply_to=new_advancement
                    replace=yes
                    {AMLA_DEFAULT}
                [/effect]
                [effect]
                    apply_to=attack
                    range=ranged
                        [set_specials]
                            mode=append
                            {WEAPON_SPECIAL_SLOW}
                        [/set_specials]
                [/effect]
                [effect]
                    apply_to=attack
                    range=melee
                    increase_damage=2
                [/effect]
                [effect]
                    apply_to=attack
                    range=ranged
                    increase_damage=1
                    increase_attacks=1
                [/effect]
                [effect]
                    apply_to=hitpoints
                    increase_total=15
                [/effect]
                [effect]
                    apply_to=level
                    set=3
                [/effect]
            [/object]
        [/modifications]
        [ai] #outlaws won't fall into the ice trap & won't fight icemonaxes
            [avoid]
                x="0,1,2,3,4,5,6,7,8,9,10,28,29,30"
	            y="9-17,10-17,9-16,10-17,9-16,9-17,9-16,10-17,10-17,11-17,11-17,5-6,5-7,5-6"
            [/avoid]
        [/ai]
#ifdef EASY
        recruit="Footpad,Thug,Thief,Poacher,RTL Wesfolk Adept,Outlaw,Bandit,Trapper"
#endif
#ifdef NORMAL
        recruit="Footpad,Thug,Thief,Poacher,RTL Wesfolk Adept,Outlaw,Bandit,Trapper,Rogue,RTL Wesfolk Sorcerer"
#endif
#ifdef HARD
        recruit="Footpad,Thug,Thief,Poacher,RTL Wesfolk Adept,Outlaw,Bandit,Trapper,Rogue,RTL Wesfolk Sorcerer,Fugitive,Highwayman"
#endif
    [/side]

    [side]
        side=4
        controller=ai
        hidden=yes
        team_name=Drakes
        user_team_name= _ "Marshinar"
        {FLAG_VARIANT long}
        color=gold
        [ai] #drakes won't fall into the ice trap
            [avoid]
                x="27,28,29,30,31"
                y="5-7,4-7,4-8,4-7,5-7"
            [/avoid]
        [/ai]
    [/side]

    [side]
        side=5
        controller=ai
        hidden=yes
        team_name=Drakes,Orcs,Wesfolk,Animals
        user_team_name= _ "Frozen"
        color=white
    [/side]

    [side]
        side=6
        controller=ai
        hidden=yes
        team_name=Animals
        user_team_name= _ "Animals"
        color=green
        [ai]
            village_value=0
        [/ai]
    [/side]

    [event]
        name=prestart

        {ROOTLESS_HELP}
        [micro_ai]
            side=6
            ai_type=zone_guardian
            action=add

            [filter]
                [not]
                    type=Frost Stoat
                [/not]
            [/filter]
            [filter_location]
                x="0,1,2,3,4,5,6,7,8,9"
                y="10-17,11-17,10-16,11-17,10-16,10-17,10-16,11-17,11-17,12-17"
            [/filter_location]
        [/micro_ai]

        [micro_ai]
            side=6
            ai_type=forest_animals
            action=add
            [filter]
                type=Frost Stoat
            [/filter]
            deer_type="Frost Stoat"
            [filter_location]
                x="21,22,23,24,25,26,27,28,29,30,31,32"
	            y="0-9,0-9,0-9,0-9,0-9,0-9,0-9,0-9,0-9,0-9,0-10,0-9"
            [/filter_location]
        [/micro_ai]

        [micro_ai] #ai goes around icemonaxes
            side=3
            ai_type=goto
            action=add
            release_unit_at_goal=yes
            [filter]
                side=3
                [not]
                    id=Clerila
                [/not]
            [/filter]
            [filter_location]
                x="16,17,18,19,20"
	            y="13-15,13-16,12-16,13-16,13-15"
            [/filter_location]
            ca_score=21000
        [/micro_ai]

        [micro_ai] #Hudoc doesn't get stupidly killed by nagas
            side=2
            ai_type=zone_guardian
            action=add

            id=ShamanKiller
            [filter_location]
                x,y=29,25
            [/filter_location]
        [/micro_ai]

        [if] #dagger gift easter egg setup
            [have_unit]
                side=1
                search_recall_list=yes
                [filter_wml]
                    [modifications]
                        [object]
                            id=dagger_gift
                        [/object]
                    [/modifications]
                [/filter_wml]
            [/have_unit]

            [then]
                [store_unit]
                    [filter]
                        role=Gift User
                    [/filter]
                    variable=assassination
                [/store_unit]
                [kill]
                    role=Gift User
                [/kill]
            [/then]
        [/if]

        [modify_unit]
            [filter]
                id=Arshag
            [/filter]
            facing=ne
        [/modify_unit]

        {VARIABLE frost_trap enabled}

        {PLACE_IMAGE (scenery/cave.png) 10 22}
        {PLACE_IMAGE (items/ring-white.png) 29 6}
        {PLACE_IMAGE (items/archery-target-right.png) 5 21}
        {PLACE_IMAGE (items/archery-target-right.png) 2 22}
        {PLACE_IMAGE (scenery/icepack-1.png) 26 11}
        {PLACE_IMAGE ("items/dummy.png~RC(magenta>red)") 4 21}
        {PLACE_IMAGE ("items/dummy.png~RC(magenta>red)") 3 22}
        {PLACE_IMAGE (scenery/tent-ruin-1.png) 3 12}
        {PLACE_IMAGE (scenery/trash.png) 4 12}

        {GENERIC_UNIT 2 (RTL Quintain) 4 21}
        {GENERIC_UNIT 2 (RTL Quintain) 3 22}

        {GENERIC_UNIT 6 (Frost Stoat) 22 5}

        {GENERIC_UNIT 6 (Great Icemonax) 4 13}
        {GENERIC_UNIT 6 (Icemonax) 1 12}
        {GENERIC_UNIT 6 (Great Icemonax) 8 14}
        {GENERIC_UNIT 6 (Icemonax) 1 15}
#ifdef EASY
        {GENERIC_UNIT 6 (Icemonax) 4 16}
        {GENERIC_UNIT 6 (Icemonax) 6 14}
#else
        {GENERIC_UNIT 6 (Great Icemonax) 4 16}
        {GENERIC_UNIT 6 (Great Icemonax) 6 14}
#endif
#ifdef HARD
        {GENERIC_UNIT 6 (Great Icemonax) 5 12}
        {GENERIC_UNIT 6 (Great Icemonax) 1 17}
#endif
        [capture_village]
            x,y=4,24
            side=1
        [/capture_village]
        [capture_village]
            x,y=10,24
            side=1
        [/capture_village]
        [capture_village]
            x,y=8,27
            side=1
        [/capture_village]
        [capture_village]
            x,y=7,24
            side=1
        [/capture_village]

        [modify_unit]
            [filter]
                type=RTL Quintain
            [/filter]
            [object]
                [effect]
                    apply_to=image_mod
                    add=RC(magenta>red)
                [/effect]
            [/object]
        [/modify_unit]

        [hide_unit]
            type=RTL Quintain
        [/hide_unit]

        [remove_shroud]
            x="0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16"
	        y="20-29,20-29,19-29,19-29,18-29,19-29,18-29,19-29,18-29,19-29,19-29,20-29,20-29,21-29,21-29,23-29,24-29"
        [/remove_shroud]

        [recall]
            id=Toruk
            x,y=8,24
            facing=se
        [/recall]
        [recall]
            id=Stuurg
            x,y=6,24
            facing=se
        [/recall]
        [recall]
            id=Grokutin
            x,y=7,25
            facing=se
        [/recall]
        [recall]
            id=Naga
            x,y=16,24
            facing=se
        [/recall]
        [if]
            [have_unit]
                search_recall_list=yes
                [filter_wml]
                    [modifications]
                        [object]
                            id=necklace_gift
                        [/object]
                    [/modifications]
                [/filter_wml]
            [/have_unit]
            [then]
                [recall]
                    role=Gift User
                    x,y=8,25
                    type_adv_tree=Wolf Rider
                [/recall]
            [/then]
        [/if]

        [objectives]

            [objective]
                description= _ "Defeat Clerila"
                condition=win
                [show_if]
                    [have_unit]
                        id=Clerila
                    [/have_unit]
                [/show_if]
            [/objective]

            [objective]
                description= _ "Unfreeze Toruk"
                condition=win
                [show_if]
                    [variable]
                        name=frozen_Toruk
                        equals=yes
                    [/variable]
                [/show_if]
            [/objective]

            [objective]
                description= _ "Unfreeze Stuurg"
                condition=win
                [show_if]
                    [variable]
                        name=frozen_Stuurg
                        equals=yes
                    [/variable]
                [/show_if]
            [/objective]

            [objective]
                description= _ "Death of Arshag"
                condition=lose
            [/objective]

            [objective]
                description= _ "Death of Stuurg"
                condition=lose
            [/objective]

            [objective]
                description= _ "Death of Toruk"
                condition=lose
                [show_if]
                    [have_unit]
                        id=Toruk
                    [/have_unit]
                [/show_if]
            [/objective]

            [gold_carryover]
                carryover_percentage=0
                bonus=no
            [/gold_carryover]

        [/objectives]

    [/event]

    [event]
        name=start

        [if]
            [have_unit]
                id=Naga
            [/have_unit]
            [then]
                [remove_shroud]
                    x="15,16,17,18,19,20,21,22,23,23,24,24,25,25,26,26,27,28,29,30,31,32"
                    y="23-24,23-24,23-24,22-24,23-24,22-23,22-23,22,11-12,22-23,10-12,21-22,10-16,21-22,9-16,19-21,9-21,9-19,10-19,10-18,10-18,10-17"
                [/remove_shroud]
                {MOVE_UNIT id=Naga 30 15}
                {VARIABLE nagas_discovered yes}
                [allow_recruit]
                    side=1
                    type=Naga Fighter
                [/allow_recruit]
                {GENERIC_UNIT 1 (Naga Fighter) 26 14}
                {GENERIC_UNIT 1 (Naga Guard) 31 14}
                {GENERIC_UNIT 1 (Naga Warrior) 29 11}
                [capture_village]
                    x,y=29,16
                    side=1
                [/capture_village]
                [capture_village]
                    x,y=26,14
                    side=1
                [/capture_village]
                [capture_village]
                    x,y=29,11
                    side=1
                [/capture_village]
                [message]
                    speaker=Naga
                    message= _ "Good newsss, Arshag! My people live here too. They'll help usss if we get them sssome iron."
                [/message]
                [message]
                    type=Naga Guard
                    message= _ "We had a deal with the sssaurians, but they left for the cavesss a few monthsss ago and we haven't heard from them sssince."
                [/message]
                [if]
                    [variable]
                        name=the_dark_branch
                        value=deep
                    [/variable]
                    [then]
                        [message]
                            speaker=Stuurg
                            message= _ "We met them in the tunnels. They went mad after eating strange mushrooms down there. They won't return."
                        [/message]
                    [/then]
                [/if]
                [message]
                    speaker=Arshag
                    message= _ "We'll gladly provide you with iron."
                [/message]
#ifdef EASY
                [message]
                    speaker=narrator
                    message= _ "You can now recruit Naga Fighters."
                    image=wesnoth-icon.png
                [/message]
#endif
                [if]
                    [have_unit]
                        id=Toruk
                    [/have_unit]
                    [then]
                        [message]
                            speaker=Toruk
                            message= _ "See, Arshag? You were right after all.

After the trolls, the nagas are joining us."
                        [/message]
                    [/then]
                    [else]
                        [message]
                            speaker=Toruk
                            message= _ "See, Arshag? You were right.

After us trolls, the nagas are joining you."
                        [/message]
                    [/else]
                [/if]
                [delay]
                    time=500
                [/delay]
            [/then]
            
        [/if]

        [if] #Toruk is already dead
            [not]
                [have_unit]
                    id=Toruk
                [/have_unit]
            [/not]
            [then]
                [message]
                    speaker=Stuurg
                    message= _ "This is a nice place. How long you plan on staying here?"
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "Just until spring when travel becomes easier. I miss Toruk's advice, but I know we can't stay here.

The forest is too close. Logalmier is too close."
                [/message]
                {MOVE_UNIT id=Clerila 7 22}
                [message]
                    speaker=Clerila
                    message= _ "I thought there was no one here but icemonaxes and suddenly I hear a familiar voice!

Greetings, Arshag!"
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "Clerila! Stay right where you are."
                [/message]
                [message]
                    speaker=Clerila
                    message= _ "I had hoped for a friendlier welcome."
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "What did Logalmier promise you if you bring him our heads?"
                [/message]
                [delay]
                    time=2000
                [/delay]
                [modify_side]
                    side=3
                    team_name=Wesfolk
                [/modify_side]
                [message]
                    speaker=Clerila
                    message= _ "You'll find out soon enough."
                [/message]
                {MOVE_UNIT id=Arshag 8 23}
                        
                [animate_unit]
                    flag=attack
                    [filter]
                        id=Clerila
                    [/filter]
                    [facing]
                        x,y=7,23
                    [/facing]
                    [primary_attack]
                        range=ranged
                    [/primary_attack]
                    hits=yes
                [/animate_unit]

                [move_unit_fake]
                    type=RTL Arrow
                    gender=female
                    side=1
                    x=7,7
                    y=23,24
                [/move_unit_fake]

                {MOVE_UNIT id=Clerila 4 2}
                [message]
                    speaker=Stuurg
                    message= _ "How did you know she works for Logalmier?"
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "I refuse to underestimate him anymore, now that Toruk is dead. He's playing with me like a cat would with a mouse."
                [/message]
            [/then]
        [/if]

        [if] #Toruk is alive; dies in the cutscene
            [have_unit]
                id=Toruk
            [/have_unit]
            [and]
                [variable]
                    name=second_event
                    not_equals=1
                [/variable]
            [/and]
            [then]
                {VARIABLE toruk_killed_clerila yes}
                [message]
                    speaker=Toruk
                    message= _ "It's beautiful here. Do you think we could settle down here for a while?"
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "We're still too close to the woods. Close to Logalmier.

As soon as spring comes, we'll head further north."
                [/message]
                {MOVE_UNIT id=Clerila 7 22}
                [message]
                    speaker=Clerila
                    message= _ "I thought there was no one here but icemonaxes and suddenly I hear familiar voices!

Greetings, Arshag and Toruk!"
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "Clerila! How did you get here?"
                [/message]
                [message]
                    speaker=Clerila
                    message= _ "It's a long story. Queen Jessene found out I helped you, so we had to flee Elensefar."
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "Then welcome. There is room among us for all who have been uprooted."
                [/message]
                [message]
                    speaker=Clerila
                    message= _ "Oh, Arshag...

I'm so sorry."
                [/message]
                [message]
                    speaker=Toruk
                    message= _ "Sorry for what?"
                [/message]
                [modify_side]
                    side=3
                    team_name=Wesfolk
                [/modify_side]
                {INCIDENTAL_MUSIC sad.ogg}
                [message]
                    speaker=Clerila
                    message= _ "For this."
                [/message]
                [message]
                    speaker=Toruk
                    message= _ "Arshag!"
                [/message]
                [store_unit]
                    [filter]
                        id=Arshag
                    [/filter]
                    variable=arshag_store
                [/store_unit]
                {ARSHAG_PLACE_IMAGE 7 24}
                [kill]
                    id=Arshag
                    animate=no
                [/kill]
                {MOVE_UNIT id=Toruk 7 24}
                [animate_unit]
                    flag=attack
                    [filter]
                        id=Clerila
                    [/filter]
                    [facing]
                        x,y=7,23
                    [/facing]
                    [primary_attack]
                        range=ranged
                    [/primary_attack]
                    hits=yes
                [/animate_unit]

                [move_unit_fake]
                    type=RTL Arrow
                    gender=female
                    side=1
                    x=7,7
                    y=23,24
                [/move_unit_fake]

                [kill]
                    id=Toruk
                    animate=yes
                [/kill]

                [remove_item]
                    x,y=7,24
                [/remove_item]

                [unstore_unit]
                    variable=arshag_store
                [/unstore_unit]

                [message]
                    speaker=Arshag
                    message= _ "KILL HER!"
                [/message]
                {MOVE_UNIT id=Clerila 4 2}
                [message]
                    speaker=Stuurg
                    message= _ "There's nothing I can do, Arshag.

Toruk is gone."
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "He died... saving me."
                [/message]

                [delay]
                    time=2000
                [/delay]

                [message]
                    speaker=Arshag
                    message= _ "Clerila will pay for this."
                [/message]
            [/then]
        [/if]

        [if] #the only way Toruk survives
            [variable]
                name=second_event
                equals=1
            [/variable]
            [and]
                [have_unit]
                    id=Toruk
                [/have_unit]
            [/and]
            [then]
                [message]
                    speaker=Toruk
                    message= _ "It's beautiful here. Do you think we could settle down here for a while?"
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "You know we can't. I'm still haunted by our vision. Logalmier isn't done with us yet.

As soon as spring comes, we'll head further north."
                [/message]
                {MOVE_UNIT id=Clerila 7 22}
                [message]
                    speaker=Clerila
                    message= _ "I thought there was no one here but icemonaxes and suddenly I hear familiar voices!

Greetings, Arshag and Toruk!"
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "Clerila! Stay right where you are."
                [/message]
                [message]
                    speaker=Clerila
                    message= _ "I had hoped for a friendlier welcome."
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "What did Logalmier promise you if you bring him our heads?"
                [/message]
                [delay]
                    time=2000
                [/delay]
                [modify_side]
                    side=3
                    team_name=Wesfolk
                [/modify_side]
                [message]
                    speaker=Clerila
                    message= _ "You'll find out soon enough."
                [/message]
                {MOVE_UNIT id=Arshag 8 23}

                [animate_unit]
                    flag=attack
                    [filter]
                        id=Clerila
                    [/filter]
                    [facing]
                        x,y=7,23
                    [/facing]
                    [primary_attack]
                        range=ranged
                    [/primary_attack]
                    hits=yes
                [/animate_unit]

                [move_unit_fake]
                    type=RTL Arrow
                    gender=female
                    side=1
                    x=7,7
                    y=23,24
                [/move_unit_fake]

                {MOVE_UNIT id=Clerila 4 2}
                [message]
                    speaker=Toruk
                    message= _ "So the vision was right. Logalmier really did send a mutual friend after us."
                [/message]
                [message]
                    speaker=Stuurg
                    message= _ "I think she isn't alone. We should get ready for a fight."
                [/message]
            [/then]
        [/if]

        [if]
            [variable]
                name=assassination.cost
                greater_than=0
            [/variable]
            [then]
                [set_variable]
                    name=image_plus_tc
                    value=$assassination.image|~RC(magenta>red)
                [/set_variable]
                [message]
                    speaker=narrator
                    image=$image_plus_tc
                    message= _ "Arshag sent one of his assassins to cause chaos in the ranks of the enemy. He can't be recalled and will appear later during the scenario."
                [/message]
                {CLEAR_VARIABLE image_plus_tc}
            [/then]
        [/if]

    [/event]

    [event]
        name=turn 2

        [message]
            speaker=Stuurg
            message= _ "If it's true that more orcs are now heading north, we can send a messenger to them."
        [/message]

        [message]
            speaker=Arshag
            message= _ "That's a good idea, Stuurg."
        [/message]

        [if] #Grokutin offers to be the messenger
            [have_unit]
                id=Grokutin
            [/have_unit]
            [then]
                [message]
                    speaker=Grokutin
                    message= _ "I shall carry your message.
My wings are strong and my inner fire protects me from the cold."
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "Thank you for the offer, Grokutin, but the orcs don't know you. They might shoot you down before you got close, or think you're trying to lure them into a trap."
                [/message]
            [/then]
        [/if]

        [if] #player doesn't have wolves yet
            [variable]
                name=fed_wolves
                equals=yes
            [/variable]
            [then]

                [unit]
                    id=Rider
                    type=Wolf Rider
                    x,y=2,26
                    facing=ne
                    side=1
                    [modifications]
                        {TRAIT_QUICK}
                    [/modifications]
                [/unit]

                [message]
                    speaker=Rider
                    message= _ "There are wolves in the forest and we already managed to tame some to replace those we lost after the Green Isle. Let me be the messenger."
                [/message]

                [message]
                    speaker=Arshag
                    message= _ "Hurry. If Clerila is indeed serving Logalmier, the elven army may be hot on her heels."
                [/message]

                {VARIABLE necklace_rider no}
                {MOVE_UNIT id=Rider 6 28}
                [store_unit]
                    [filter]
                        id=Rider
                    [/filter]
                    variable=rider_store
                [/store_unit]
                [kill]
                    id=Rider
                    animate=no
                [/kill]

                [allow_recruit]
                    side=1
                    type=Wolf Rider
                [/allow_recruit]
#ifdef EASY
                [message]
                    speaker=narrator
                    message= _ "You can now recruit Wolf Riders."
                    image=wesnoth-icon.png
                [/message]
#endif
            [/then]
            [else] #player already has wolves
                [if]
                    [have_unit]
                        [filter_wml]
                            [modifications]
                                [object]
                                    id=necklace_gift
                                [/object]
                            [/modifications]
                        [/filter_wml]
                    [/have_unit]
                    [then]
                        [message]
                            role=Gift User
                            message= _ "I will carry the message. I still have the necklace we made for the dwarves. Now it's time to use the speed it gives me."
                        [/message]
                        [message]
                            speaker=Arshag
                            message= _ "Ride swiftly."
                        [/message]
                        {VARIABLE necklace_rider yes}
                        {MOVE_UNIT role="Gift User" 6 28}
                        [store_unit]
                            [filter]
                                role=Gift User
                            [/filter]
                            variable=rider_store
                        [/store_unit]
                        [kill]
                            role=Gift User
                            animate=no
                        [/kill]
                    [/then]
                    [else]
                        [unit]
                            id=Rider
                            type=Wolf Rider
                            x,y=8,25
                            facing=nw
                            side=1
                            [modifications]
                                {TRAIT_QUICK}
                            [/modifications]
                        [/unit]
                        [message]
                            speaker=Rider
                            message= _ "I will carry the message."
                        [/message]
                        [message]
                            speaker=Arshag
                            message= _ "Alright. Ride swiftly."
                        [/message]
                        {VARIABLE necklace_rider no}
                        {MOVE_UNIT id=Rider 6 28}
                        [store_unit]
                            [filter]
                                id=Rider
                            [/filter]
                            variable=rider_store
                        [/store_unit]
                        [kill]
                            id=Rider
                            animate=no
                        [/kill]
                    [/else]
                [/if]
                {IF_WOLF_SAY "<i>Arshag's wolf looks longingly after the rider. You can tell he longs to run across the snowy plains himself.</i>"}
            [/else]
        [/if]
    [/event]

    [event] #Hudoc should now be mostly safe from the nagas; removing his micro_ai
        name=turn 3

        [micro_ai]
            side=2
            ai_type=zone_guardian
            action=delete
        [/micro_ai]
    [/event]


    [event] #the player gets nagas
        name=moveto

        [filter]
            x="25,26,27,28,29,29,30,31,32"
	        y="11-16,10-16,10-17,9-17,10-12,15-18,10-18,11-18,11-17"
            side=1
        [/filter]

        [remove_shroud]
            x="20,21,22,23,24,25,26,27,28,29,30,31,32"
	        y="10-11,11-12,10-12,10-13,9-17,9-19,8-20,8-20,7-19,8-19,8-18,9-18,9-17"
            side=1
        [/remove_shroud]

        [filter_condition]
            [variable]
                name=nagas_discovered
                not_equals=yes
            [/variable]
        [/filter_condition]

        {VARIANT_SAY "Lake have green, snaky things live there." "There are nagasss living in thisss lake!" "Green creatures, like snakes, live in this lake." "There are nagas living in this lake!"}

        {VARIABLE nagas_discovered yes}
        [allow_recruit]
            side=1
            type=Naga Fighter
        [/allow_recruit]
        {GENERIC_UNIT 1 (Naga Fighter) 26 14}
        {GENERIC_UNIT 1 (Naga Guard) 31 14}
        {GENERIC_UNIT 1 (Naga Warrior) 29 11}
        
        [capture_village]
            x,y=29,16
            side=1
        [/capture_village]
        [capture_village]
            x,y=26,14
            side=1
        [/capture_village]
        [capture_village]
            x,y=29,11
            side=1
        [/capture_village]

        [message]
            type=Naga Guard
            message= _ "The pink creaturesss have ssset up camp right next to our lake. When we get clossse, they ssshoot arrowsss at usss."
        [/message]
        [message]
            speaker=Arshag
            message= _ "They are our enemies as well. Let us join forces against them."
        [/message]

#ifdef EASY
        [message]
            speaker=narrator
            message= _ "You can now recruit Naga Fighters."
            image=wesnoth-icon.png
        [/message]
#endif
    [/event]

    [event] #if the player angered Marshinar enough, he returns to avenge his son
        name=turn 12

        [filter_condition]
            [variable]
                name=marshinar_revenge.id
                equals=Marshinar
            [/variable]
        [/filter_condition]

        [remove_shroud]
            x="9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24"
	        y="0,0,0-1,0-1,0-2,0-2,0-3,0-3,0-4,0-3,0-3,0-2,0-2,0-1,1,0"
        [/remove_shroud]

        [modify_side]
            side=4
            hidden=no
            income=0
            gold=0
#ifdef EASY
#else
            team_name=Wesfolk
#endif
        [/modify_side]

        [unstore_unit]
            variable=marshinar_revenge
            x,y=17,3
            find_vacant=yes
        [/unstore_unit]

#ifdef EASY
        {NAMED_GENERIC_UNIT 4 "Drake Glider" 16 2 "Rogue Drake" "Rogue Drake"}
        {NAMED_GENERIC_UNIT 4 "Drake Fighter" 18 2 "Rogue Drake" "Rogue Drake"}
        {NAMED_GENERIC_UNIT 4 "Drake Burner" 15 2 "Rogue Drake" "Rogue Drake"}
        {NAMED_GENERIC_UNIT 4 "Drake Fighter" 19 2 "Rogue Drake" "Rogue Drake"}
#endif
#ifdef NORMAL
        {NAMED_GENERIC_UNIT 4 "Sky Drake" 16 2 "Rogue Drake" "Rogue Drake"}
        {NAMED_GENERIC_UNIT 4 "Drake Warrior" 18 2 "Rogue Drake" "Rogue Drake"}
        {NAMED_GENERIC_UNIT 4 "Fire Drake" 15 2 "Rogue Drake" "Rogue Drake"}
        {NAMED_GENERIC_UNIT 4 "Drake Fighter" 19 2 "Rogue Drake" "Rogue Drake"}
#endif
#ifdef HARD
        {NAMED_GENERIC_UNIT 4 "Hurricane Drake" 16 2 "Rogue Drake" "Rogue Drake"}
        {NAMED_GENERIC_UNIT 4 "Drake Warrior" 18 2 "Rogue Drake" "Rogue Drake"}
        {NAMED_GENERIC_UNIT 4 "Fire Drake" 15 2 "Rogue Drake" "Rogue Drake"}
        {NAMED_GENERIC_UNIT 4 "Drake Warrior" 19 2 "Rogue Drake" "Rogue Drake"}
#endif
        [message]
            speaker=Marshinar
            message= _ "The time of my vengeance has come.
I shall burn this prey in memory of my son."
        [/message]

#ifdef EASY
#else
        [message]
            speaker=Clerila
            message= _ "Who are you seeking revenge on, drake?"
        [/message]

        [message]
            speaker=Marshinar
            message= _ "Not you."
        [/message]

        [message]
            speaker=Clerila
            message= _ "Then we're on the same side."
        [/message]
#endif
    [/event]

    [event] #if the player has the necklace-upgraded wolf, they'll get some reinforcements
        name=turn 15

        [filter_condition]
            [variable]
                name=necklace_rider
                equals=yes
            [/variable]
        [/filter_condition]

        [unstore_unit]
            variable=rider_store
            find_vacant=yes
        [/unstore_unit]
        {CLEAR_VARIABLE rider_store}

#ifdef EASY
        {LOYAL_UNIT 1 (Goblin Pillager) 5 28}
        {GENERIC_UNIT 1 (Goblin Knight) 4 28}
#else
        {GENERIC_UNIT 1 (Goblin Pillager) 5 28}
        {GENERIC_UNIT 1 (Wolf Rider) 4 28}
#endif
        [message]
            role=Gift User
            message= _ "I'm back! The warlords will arrive soon, Arshag. For now I have brought riders who could keep up with me."
        [/message]

        [set_achievement]
            content_for=RTL_SP
            id=RTL_wolf
        [/set_achievement]
    [/event]

    [event] #cave entrance
        name=moveto

        [filter]
            side=1
            x,y=10,22
        [/filter]

        [if]
            [variable]
                name=the_dark_branch
                equals=deep
            [/variable]
            [then]
                [if] #added check since only the original naga went with the orcs to the Abyss
                    [have_unit]
                        id=Naga
                        x,y=10,22
                    [/have_unit]
                    [then]
                        [message]
                            speaker=Naga
                            message= _ "Thisss isss the cave we used to get from the depthsss back to the sssurface."
                        [/message]
                    [/then]
                    [else]
                        {VARIANT_SAY "Me miss home underground, but no use go back." "The cave goesss deep. Exploring it now would be a wassste of time." "I miss home underground, but we can't go back." "This is the cave we used to get from the depths back to the surface."}
                    [/else]
                [/if]
            [/then]
            [else]
                [if]
                    [have_unit]
                        x,y=10,22
                        id=Grokutin
                    [/have_unit]
                    [then]
                        [message]
                            speaker=Grokutin
                            message= _ "We drakes hold no great fondness for caves.
I would avoid entering such a place."
                        [/message]
                    [/then]
                    [else]
                        {VARIANT_SAY "Cave go deep. Going in now waste time." "The cave goesss deep. Exploring it now would be a wassste of time." "I think this leads back home underground. We can't go back though." "The cave goes deep. Exploring it now would be a waste of time."}
                    [/else]
                [/if]
            [/else]
        [/if]
    [/event]

    [event]
        name=die
        first_time_only=no
        [filter]
            type=Icemonax,Great Icemonax
        [/filter]
        {VARIABLE_OP icemonax_conservation_status add 1}
        [if]
            [variable]
                name=icemonax_conservation_status
#ifdef HARD
                equals=6
#else
                equals=4
#endif
            [/variable]
            [then]
                [micro_ai]
                    side=3
                    ai_type=goto
                    action=delete
                [/micro_ai]
                [modify_side]
                    side=3
                    [ai]
                        [avoid]
                            x="27,28,29,30,31"
                            y="5-7,4-7,4-8,4-7,5-7"
                        [/avoid]
                    [/ai]
                [/modify_side]
            [/then]
        [/if]
    [/event]

    [event] #frost ring trap
        name=enter_hex
        first_time_only=no
        [filter]
            x="28,29,29,30"
	        y="5-6,5,7,5-6"
            [not]
                type=Frost Stoat
            [/not]
            [not]
                type_adv_tree=Ghost
            [/not]
            [not]
                [filter_wml]
                    [modifications]
                        [object]
                            id=stoat_fur
                        [/object]
                    [/modifications]
                [/filter_wml]
            [/not]
            [not]
                [filter_wml]
                    [modifications]
                        [object]
                            id=1stoat_fur
                        [/object]
                    [/modifications]
                [/filter_wml]
            [/not]
            [not]
                [filter_wml]
                    [modifications]
                        [object]
                            id=2stoat_fur
                        [/object]
                    [/modifications]
                [/filter_wml]
            [/not]
        [/filter]

        [filter_condition]
            [variable]
                name=frost_trap
                not_equals=disabled
            [/variable]
        [/filter_condition]

        [if]
            [variable]
                name=frost_trap
                equals=enabled
            [/variable]
            [then]
                {VARIABLE frost_trap triggered}
                {VARIANT_SAY "Me... cold." "I feel... cold." "I'm... cold." "I feel... cold."}
            [/then]
        [/if]

        [cancel_action]
        [/cancel_action]

        [modify_unit]
            [filter]
                id=$unit.id
                [not]
                    type=Goblin Pillager
                [/not]
            [/filter]
            side=5
            [object]
                id=rtl_frozen_2
                [effect]
                    apply_to=image_mod
                    add=~GS()~CS(40,60,120)
                [/effect]
                [effect]
                    apply_to=status
                    add=rtlfrozen
                [/effect]
            [/object]
        [/modify_unit]

        [redraw]
        [/redraw]

        [if]
            [have_unit]
                id=Stuurg,Toruk
                x=$unit.x
                y=$unit.y
            [/have_unit]
            [then]
                [message]
                    speaker=Arshag
                    message= _ "No! He's frozen now!"
                [/message]
#ifdef EASY
#else
                [set_variable]  
                    name=frozen_$unit.id
                    value=yes
                [/set_variable]
                [show_objectives][/show_objectives]
#endif
            [/then]
        [/if]

        [modify_unit]
            [filter]
                id=$unit.id
                type=Goblin Pillager
            [/filter]
            side=5
            [object]
                id=rtl_frozen_2
                [effect]
                    apply_to=image_mod
                    add=~GS()~CS(40,60,120)
                [/effect]
                [effect]
                    apply_to=status
                    add=rtlfrozen
                [/effect]
                [effect]
                    apply_to=new_animation
                    [standing_anim]
                        start_time=0
                        [frame]
                            image="units/pillager-nofire.png"
                        [/frame]
                    [/standing_anim]
                [/effect]
            [/object]
        [/modify_unit]

        [sound]
            name=frozen.ogg
        [/sound]

    [/event]

    [event]
        name=moveto
        first_time_only=no

        [filter]
            side=1
            x,y=29,6
            [not]
                type_adv_tree=Ghost
            [/not]
        [/filter]

        [filter_condition]
            [variable]
                name=frost_trap
                not_equals=disabled
            [/variable]
        [/filter_condition]

        [message]
            speaker=unit
            caption=""
            image="wesnoth-icon.png"
            male_message= _ "What should $unit.name| do with the the ring?"
            female_message= _ "What should female^Should $unit.name| do with the the ring?"
            [option]
                label= _ "Equip the ring"
                [command]
                    [remove_item]
                        x,y=29,6
                    [/remove_item]
                    [object]
                        id=frost_ring
                        name= _ "The Ring of Frost"
                        image=items/ring-white.png
                        duration=forever
                        description= _ "The Ring of Frost allow the unit to freeze an enemy, so he skips the rest of the turn. The frozen unit can't be attacked."
                        [effect]
                            apply_to=new_attack
                            name=frost_ring_effect
                            description= _ "frost ring"
                            icon=icons/jewelry_ring_prismatic.png
                            type=cold
                            range=ranged
                            damage=0
                            number=1
                            [specials]
                                {WEAPON_SPECIAL_MAGICAL}
                                {WEAPON_SPECIAL_FROSTBIND}
                                {WEAPON_SPECIAL_ATTACK_EFFECT}
                            [/specials]
                        [/effect]
                        [effect]
                            apply_to=new_animation
                            [attack_anim]
                                [filter_attack]
                                    name=frost_ring_effect
                                [/filter_attack]
                                {HALO_FRAME_SAURIAN}
                                {MISSILE_FRAME_ICE}
                                start_time=-200
                            [/attack_anim]
                        [/effect]
                    [/object]

                    {VARIABLE frost_trap disabled}

                    [modify_unit]
                        [filter]
                            side=5
                        [/filter]
                        [object]
                            id=rtl_unfrozen
                            [effect]
                                apply_to=status
                                remove=rtlfrozen
                            [/effect]
                        [/object]
                    [/modify_unit]

                    [modify_unit]
                        [filter]
                            side=5
                        [/filter]
                        side=1
                    [/modify_unit]
                    {CLEAR_VARIABLE frozen_Stuurg}
                    {CLEAR_VARIABLE frozen_Toruk}

                    [remove_object]
                        object_id=rtl_frozen_2
                    [/remove_object]
                    [remove_object]
                        object_id=rtl_unfrozen
                    [/remove_object]

                    [if]
                        [not]
                            [have_unit]
                                id=Clerila
                            [/have_unit]
                        [/not]
                        [then]
                            [message]
                                speaker=Arshag
                                message= _ "The ice has broken up!

We're back together and I can explain my plan."
                            [/message]
                            {CLEAR_VARIABLE necklace_rider}
                            {CLEAR_VARIABLE stoat_countdown}
                            [if]
                                [variable]
                                    name=attacked_icemonaxes
                                    not_equals=yes
                                [/variable]
                                [then]
                                    [set_achievement]
                                        content_for=RTL_SP
                                        id=RTL_conservationist
                                    [/set_achievement]
                                [/then]
                            [/if]
                            [endlevel]
                                result=victory
                                bonus=no
                                {NEW_GOLD_CARRYOVER 0}
                            [/endlevel]
                        [/then]
                    [/if]
                [/command]
            [/option]
            [option]
                label= _ "Nothing"
                [command]
                    [allow_undo][/allow_undo]
                [/command]
            [/option]
        [/message]

    [/event]

    [event] #frost ring flavour
        name=enter_hex

        [filter]
            x="28,29,29,30"
	        y="5-6,5,7,5-6"
            side=1
            [filter_wml]
                [modifications]
                    [object]
                        id=stoat_fur
                    [/object]
                [/modifications]
                [or]
                    [modifications]
                        [object]
                            id=1stoat_fur
                        [/object]
                    [/modifications]
                [/or]
                [or]
                    [modifications]
                        [object]
                            id=2stoat_fur
                        [/object]
                    [/modifications]
                [/or]
            [/filter_wml]
        [/filter]

        [filter_condition]
            [variable]
                name=frost_trap
                not_equals=disabled
            [/variable]
        [/filter_condition]

        [if]
            [have_unit]
                x=$unit.x
                y=$unit.y
                id=Grokutin
            [/have_unit]
            [then]
                [message]
                    speaker=Grokutin
                    message= _ "The cold strikes to the very marrow of my bones!
Even as I gather close within my fur, I sense the ebbing of my inner flame."
                [/message]
            [/then]
            [else]
                {VARIANT_SAY "So cold! If me no fur, me freeze to bone." "It'sss cold! If I didn't have the ssstoat fur, I might freeze to the bone." "So cold! If I had no fur, I would freeze to the bone." "It's so cold here! If I didn't have the stoat fur, I might freeze to the bone."}
            [/else]
        [/if]

        [cancel_action]
        [/cancel_action]
    [/event]

    [event] #Hudoc reminder + dagger easter egg
        name=moveto
        [filter]
            side=1
            [not]
                race=naga
            [/not]
            x="23,24,25,26,27,28,29,30,31,32"
	        y="24-29,23-29,23-29,22-29,22-29,22-29,22-29,21-29,22-29,22-29"
        [/filter]

        [if]
            [variable]
                name=assassination.cost
                greater_than=0
            [/variable]
            [then]
                [message]
                    speaker=Arshag
                    message= _ "That's the ranger who killed my mother! Slay him!"
                [/message]
                [store_unit]
                    [filter]
                        id=ShamanKiller
                    [/filter]
                    variable=hudoc
                [/store_unit]
                [kill]
                    id=ShamanKiller
                    animate=yes
                [/kill]
                {VARIABLE_OP assassination.experience add 24}
                [unstore_unit]
                    variable=assassination
                    x=$hudoc.x
                    y=$hudoc.y
                [/unstore_unit]
                {CLEAR_VARIABLE hudoc}
                {CLEAR_VARIABLE assassination}
                [message]
                    role=Gift User
                    message= _ "As you wish, Arshag."
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "Oh. That was rather quick."
                [/message]
                [set_achievement]
                    content_for=RTL_SP
                    id=RTL_titfortat
                [/set_achievement]
            [/then]
            [else]
                [message]
                    speaker=Arshag
                    message= _ "I see my mother's killer is now working with Clerila.

He'll get what he deserves."
                [/message]
                [gold]
                    side=2
                    amount=50
                [/gold]
            [/else]
        [/if]
    [/event]

    [event]
        name=die
        first_time_only=no #so the stoat doesn't drop fur in the area around the ring
        [filter]
            type=Frost Stoat
            x="28,29,30"
			y="5-6,5-7,5-6"
        [/filter]
        [message]
            speaker=narrator
            message= _ "When the frost stoat drops dead, a strange thing happens. His body instantly freezes to the bone!

If the orcs want his fur, they'll have to hunt another one."
            image=wesnoth-icon.png
        [/message]
        {GENERIC_UNIT 6 (Frost Stoat) 22 5}
    [/event]

    [event]
        name=die
        first_time_only=no #you can get up to 3 units with cold resistance, so you have more freedom in deciding who will equip the ring

        [filter]
            type=Frost Stoat
            [not]
                x="28,29,30"
			    y="5-6,5-7,5-6"
            [/not]
        [/filter]
        {VARIABLE furX $x1}
        {VARIABLE furY $y1}
        {PLACE_IMAGE (items/fur.png) ($furX) ($furY)}
    [/event]

    [event] #equiping the fur
        name=moveto
        first_time_only=no
        [filter]
            side=1
            x=$furX
            y=$furY
            [not]
                id="Arshag","Toruk","Stuurg"
            [/not]
            [not]
                role=Eternal Servitude
            [/not]
            [not]
                role=Gift Bearer
            [/not]
            [not]
                role=Gift User
            [/not]
            [not]
                role=Xbowman
            [/not]
            [not]
                type_adv_tree=Ghost
            [/not]
            [not]
                [filter_wml]
                    [modifications]
                        [object]
                            id=swimming_guide
                        [/object]
                    [/modifications]
                [/filter_wml]
            [/not]
        [/filter]

        [message]
            speaker=unit
            caption=""
            image="wesnoth-icon.png"
            male_message= _ "What should $unit.name| do with the the fur?"
            female_message= _ "What should female^Should $unit.name| do with the the fur?"
            [option]
                label= _ "Equip the fur"
                [command]
                    [remove_item]
                        x=$furX
                        y=$furY
                    [/remove_item]
                    {CLEAR_VARIABLE furX}
                    {CLEAR_VARIABLE furY}
                    [object]
                        id=$stoat_countdown|stoat_fur
                        name= _ "Fur of the Frost Stoat"
                        image=items/fur.png
                        duration=forever
                        description= _ "Fur of the Frost Stoat provides the unit with 40 % resistance to cold."
                        [effect]
                            apply_to=resistance
                            replace=yes
                            [resistance]
                                cold=60
                            [/resistance]
                        [/effect]
                        [effect]
                            apply_to=overlay
                            add="misc/gift-icon.png"
                        [/effect]
                    [/object]
                    [if]
                        [variable]
                            name=stoat_countdown
                            not_equals=2
                        [/variable]
                        [then]
                            {VARIABLE_OP stoat_countdown add 1}
                            {GENERIC_UNIT 6 (Frost Stoat) 22 5}
                        [/then]
                    [/if]
                    {HINT_ITEM}
                [/command]
            [/option]
            [option]
                label= _ "Nothing"
                [command]
                    [allow_undo][/allow_undo]
                [/command]
            [/option]
        [/message]
    [/event]

    [event]
        name=moveto

        [filter]
            side=1
            x,y=29,6
            type_adv_tree=Ghost
        [/filter]

        [filter_condition]
            [variable]
                name=frost_trap
                not_equals=disabled
            [/variable]
        [/filter_condition]

        [message]
            speaker=unit
            message= _ "I can feel strong magic flowing from the ring. It could be dangerous, be careful!"
        [/message]
    [/event]

    [event]
        name=last breath
        [filter]
            id=ShamanKiller
        [/filter]

        [if]
            [have_unit]
                id=Arshag
                x=$second_unit.x
                y=$second_unit.y
            [/have_unit]
            [then]
                [message]
                    speaker=Arshag
                    message= _ "My vengeance is complete!"
                [/message]
                [message]
                    speaker=ShamanKiller
                    message= _ "When I killed the shaman, I was just following queen Jessene's orders. She is your real enemy, she and Lord Logalmier."
                [/message]
                [message]
                    speaker=Arshag
                    message= _ "I already figured that out. They conspired to stop the orc threat before we could settle on this continent."
                [/message]
                [message]
                    speaker=ShamanKiller
                    message= _ "Seeking revenge will get you nowhere. Your enemies are always one step ahead."
                [/message]
            [/then]
            [else]
                [message]
                    speaker=Arshag
                    message= _ "My mother's killer is finally brought down."
                [/message]
                [message]
                    speaker=ShamanKiller
                    message= _ "I was just following queen Jessene's orders. She is your real enemy, she and Lord Logalmier.

Your enemies are always one step ahead."
                [/message]
            [/else]
        [/if]
        [gold]
            side=3
            amount={ON_DIFFICULTY 50 100 150}
        [/gold]
    [/event]

    [event] #throwback to scenario 1
        name=attacker hits
        [filter]
            id=Arshag
        [/filter]
        [filter_second]
            id=Clerila
        [/filter_second]
        [filter_attack]
            special_id=slow
        [/filter_attack]

        [message]
            speaker=Clerila
            message= _ "Using my own trick against me? That's dirty."
        [/message]

    [/event]

    [event]
        name=last breath
        [filter]
            id=Clerila
        [/filter]

        {MOVE_UNIT id=Arshag $unit.x $unit.y}

        [message]
            speaker=Clerila
            message= _ "You know, Arshag, I always knew I'd die young. But I never thought it would be so far from home, in the service of a queen I despise."
        [/message]
        [message]
            speaker=Arshag
            message= _ "The world doesn't care much about what we wish for. If you hadn't followed me here, I'd remember you as one of a few friends I've made during this journey."
        [/message]

        [if]
            [variable]
                name=toruk_killed_clerila
                equals=yes
            [/variable]
            [then]
                {DEAD_TORUK Clerila "Arshag, I'm so sorry about Toruk. I didn't want him to die."}
                {DEAD_TORUK Arshag "You did want to kill me though."}
            [/then]
        [/if]
        
        [message]
            speaker=Clerila
            message= _ "I had to. Queen Jessene found out we helped you escape from Elensefar and sentenced us to death for treason.
            
But then word came from Lord Logalmier that you escaped him underground. He needed someone to search the mountains during the winter."
        [/message]
        [message]
            speaker=Arshag
            message= _ "He doesn't want to risk the precious lives of elves in the freezing cold, does he?"
        [/message]
        [message]
            speaker=Clerila
            message= _ "I guess that's part of it.

But he also heard that orc ships were turning north. Logalmier is preparing a large army, and as soon as spring comes, he will march in this direction to wipe out any orcs he encounters."
        [/message]
        [message]
            speaker=Arshag
            message= _ "He knows we're not going anywhere over the winter."
        [/message]
        [message]
            speaker=Clerila
            message= _ "Yeah. I'm sorry, Arshag."
        [/message]
        [kill]
            id=Clerila
            animate=yes
        [/kill]

        [message]
            id=Stuurg
            message= _ "Let the fallen go back to the stone, and not rise again as the undead."
        [/message]

        [delay]
            time=1000
        [/delay]

        {NAMED_LOYAL_UNIT 1 (Orcish Warlord) 16 27 (Progho) ( _ "Tan-Progho")}
        {GENERIC_UNIT 1 (Orcish Slurbow) 16 28}
        {GENERIC_UNIT 1 (Goblin Rouser) 17 28}
        {GENERIC_UNIT 1 (Goblin Knight) 15 28}

        [message]
            speaker=Progho
            message= _ "From what I can see, we're too late."
        [/message]
        [message]
            speaker=Arshag
            message= _ "No. We're all exactly where Lord Logalmier wants us."
        [/message]
        [message]
            speaker=Progho
            message= _ "So what, assassin? More warlords are following me.

Legions of orcs, many with experience from the war for the Green Isle and raids on the continent. It's a large army."
        [/message]
        [message]
            speaker=Arshag
            message= _ "Yes, but all our elders and all our children are also part of it. If we lose the battle with the elves, it's over.

And Logalmier will not fight fair."
        [/message]
        [message]
            speaker=Progho
            message= _ "Are you trying to imply that you have a better idea?"
        [/message]
        
#ifdef EASY
        [modify_unit]
            [filter]
                side=5
                [filter_wml]
                    [modifications]
                        [object]
                            id=rtl_frozen_2
                        [/object]
                    [/modifications]
                [/filter_wml]
            [/filter]
            [object]
                id=rtl_unfrozen
                [effect]
                    apply_to=status
                    remove=rtlfrozen
                [/effect]
            [/object]
            side=1
        [/modify_unit]
        [remove_object]
            object_id=rtl_frozen_2
        [/remove_object]
        [remove_object]
            object_id=rtl_unfrozen
        [/remove_object]
#endif

        [if]
            [variable]
                name=frozen_Toruk
                equals=yes
            [/variable]
            [or]
                [variable]
                    name=frozen_Stuurg
                    equals=yes
                [/variable]
            [/or]
            [then]
                [message]
                    speaker=Arshag
                    message= _ "I'll explain everything, but first we have to break the ice curse."
                [/message]
                [show_objectives][/show_objectives]
            [/then]
            [else]
                [message]
                    speaker=Arshag
                    message= _ "We'll wait for the others.

Then I'll lay out my plan."
                [/message]
                {CLEAR_VARIABLE necklace_rider}
                {CLEAR_VARIABLE stoat_countdown}
                [if]
                    [variable]
                        name=attacked_icemonaxes
                        not_equals=yes
                    [/variable]
                    [then]
                        [set_achievement]
                            content_for=RTL_SP
                            id=RTL_conservationist
                        [/set_achievement]
                    [/then]
                [/if]
                [endlevel]
                    result=victory
                    bonus=no
                    {NEW_GOLD_CARRYOVER 0}
                [/endlevel]
            [/else]
        [/if]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x,y=3,12
        [/filter]
        [if]
            [have_unit]
                x=$unit.x
                y=$unit.y
                id=Grokutin
            [/have_unit]
            [then]
                [message]
                    speaker=Grokutin
                    message= _ "I see the remains of someone.
Maybe the icemonaxes killed him.
Rats are eating his body."
                [/message]
            [/then]
            [else]
                {VARIANT_SAY "Me see body, maybe die from ice monster. Rat eat him." "I sssee the remainsss of sssomeone, probably killed by icemonaxesss. He'sss being gnawed on by ratsss." "I see remains, maybe killed by ice monsters. Rats chew on them." "I see the remains of someone, probably killed by icemonaxes. He's being gnawed on by rats."}
            [/else]
        [/if]

        {GENERIC_UNIT 6 (Giant Rat) 3 12}
        {GENERIC_UNIT 6 (Giant Rat) 3 12}
        {GENERIC_UNIT 6 (Giant Rat) 3 12}
    [/event]

    [event]
        name=die
        [filter]
            type=Giant Rat
        [/filter]
        [filter_second]
            side=1
        [/filter_second]
        [filter_condition]
            [not]
                [have_unit]
                    type=Giant Rat
                [/have_unit]
            [/not]
        [/filter_condition]
        [if]
            [have_unit]
                x=$second_unit.x
                y=$second_unit.y
                id=Grokutin
            [/have_unit]
            [then]
                [message]
                    speaker=Grokutin
                    message= _ "Strange.
The one in the tent carried no weapon.
All he had was a flute."
                [/message]
            [/then]
            [else]
                [if]
                    [have_unit]
                        id=$second_unit.id
                        race=troll,ogre
                        [not]
                            type=Troll Shaman, RTL Great Shaman
                        [/not]
                    [/have_unit]
                    [then]
                        [message]
                            speaker=second_unit
                            message= _ "Strange. The one in tent no have weapon, only flute."
                        [/message]
                    [/then]
                    [elseif]
                        [have_unit]
                            id=$second_unit.id
                            race=naga
                        [/have_unit]
                        [then]
                            [message]
                                speaker=second_unit
                                message= _ "Ssstrange. The one in the tent didn't have a weapon, jussst a flute."
                            [/message]
                        [/then]
                    [/elseif]
                    [else]
                        [message]
                            speaker=second_unit
                            message= _ "Strange. The one in the tent didn't have a weapon, just a flute."
                        [/message]
                    [/else]
                [/if]
            [/else]
        [/if]
    [/event]

    [event]
        name=post advance
        first_time_only=no

        [filter]
            type=RTL Quintain Depleted
        [/filter]

        [hide_unit]
            type=RTL Quintain Depleted
        [/hide_unit]
    [/event]

    [event]
        name=attack
        [filter]
            side=1
        [/filter]
        [filter_second]
            type=RTL Quintain
        [/filter_second]
        [set_achievement]
            content_for=RTL_SP
            id=RTL_quintain
        [/set_achievement]
    [/event]
    [event]
        name=attack
        [filter]
            side=1
        [/filter]
        [filter_second]
            type=Icemonax,Great Icemonax
        [/filter_second]
        {VARIABLE attacked_icemonaxes yes}
    [/event]
[/scenario]
