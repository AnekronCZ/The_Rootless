#textdomain wesnoth-rtl

[scenario]
    id=05b_The_Deep
    name= _ "The Deep"
    map_data="{~add-ons/The_Rootless/maps/05b_The_Deep.map}"
    {TURNS 47 45 42}
    next_scenario=06_The_Rootless
    victory_when_enemies_defeated=no

    {SCENARIO_MUSIC the_deep_path.ogg}
    {EXTRA_SCENARIO_MUSIC siege_of_laurelmor.ogg}
    {EXTRA_SCENARIO_MUSIC heroes_rite.ogg}

    {DEATHS_THE_DEEP}
    {FISH_DEATHS}
    {STAFF_OF_HAUNTING}
    {RECALL_DISCOUNT}
    {MAIN_CHARACTERS_EVENTS}
    {RECRUIT_PURPLE_TROLLS}
    {THE_DEEP_BRAZIERS}
    {DEEP_SAURIANS}
    {DEEP_SAURIANS_ORACLE}
    {DREAM_CLEARED morv_enc}
    {DREAM_CLEARED birm_enc}
    {DREAM_CLEARED loga_enc}
    {DREAM_CLEARED zofa_enc}
    {DREAM_CLEARED orc_enc}
    {SAURIAN_WAVE}
    {TROLL_ADVANCEMENTS_CHECK "Troll"}
    {TROLL_ADVANCEMENTS_CHECK "Troll Shaman"}
    {TROLL_ADVANCEMENTS_CHECK "Troll Rocklobber"}
    {TROLL_ADVANCEMENTS_CHECK "Troll Warrior"}

    {RTL_TRACK {JOURNEY_05_NEW}}

    [time]
		blue=-40
		green=-55
		id="abyss"
		image="schedule/abyss.png"
    	lawful_bonus=-33
		name=_"The Abyss"
		red=-55
	[/time]

    [side]
        side=1
        controller=human
        {GOLD 250 230 210}
        {INCOME 3 2 1}
        team_name=Orcs
        user_team_name= _ "Orcs"
        {FLAG_VARIANT6 ragged}
        recruit="Orcish Archer,Goblin Spearman,Orcish Grunt,Orcish Assassin"
        type=Orcish Assassin
        id=Arshag
        shroud=yes
        fog=no
        unrenamable=yes
        facing=ne
        name= _ "Arshag"
        profile=portraits/arshag.webp
        x,y=2,43
        [modifications]
            {TRAIT_INTELLIGENT}
        [/modifications]
        canrecruit=yes
    [/side]

    [side]
        side=2
        controller=ai
        hidden=yes
        team_name=Deep Saurians
        user_team_name= _ "Deep Saurians"
        color=brown
    [/side]

    [side]
        side=3
        controller=ai
        hidden=yes
        team_name=Monsters
        user_team_name= _ "Monsters"
        color=green
        [ai]
            village_value=0
            aggression=0.9
        [/ai]
    [/side]

    [side]
        side=4
        controller=ai
        hidden=yes
        team_name=Undead
        user_team_name= _ "Undead"
        {FLAG_VARIANT undead}
        color=white
        [ai]
            aggression=0.8
            [avoid] #so the undead won't steal the only 2 villages on the map
                x="6,12"
                y="42,43"
            [/avoid]
        [/ai]
    [/side]

    [side]
        side=5
        controller=ai
        hidden=yes
        team_name=Ghosts
        user_team_name= _ "Ghosts"
    [/side]

    [event]
        name=prestart

        {ROOTLESS_HELP}
        {HINT_TROLL}
        {PLACE_IMAGE (items/altar-evil.png) 28 28}
        {PLACE_IMAGE (scenery/monolith2.png) 5 44}
        {PLACE_IMAGE (scenery/monolith2.png) 19 37}
        {PLACE_IMAGE (scenery/monolith2.png) 12 27}
        {PLACE_IMAGE (scenery/monolith2.png) 3 28}
        {PLACE_IMAGE (scenery/monolith2.png) 10 22}
        {PLACE_IMAGE (scenery/monolith2.png) 5 19}
        {PLACE_IMAGE (scenery/monolith2.png) 10 14}
        {PLACE_IMAGE (scenery/monolith2.png) 9 9}
        {PLACE_IMAGE (scenery/monolith2.png) 10 4}
        {PLACE_IMAGE (scenery/monolith2.png) 4 5}
        {PLACE_IMAGE (scenery/slab1.png) 3 30}
        {PLACE_IMAGE ("items/vacant.png") 2 43}
        {PLACE_IMAGE ("items/vacant.png~GS()") 1 44}
        {PLACE_IMAGE ("items/vacant.png~GS()") 1 43}
#ifdef EASY
        {PLACE_IMAGE ("items/vacant.png~GS()") 2 44}
        {PLACE_IMAGE ("items/vacant.png~GS()") 3 44}
#endif
#ifdef NORMAL
        {PLACE_IMAGE ("items/vacant.png~GS()") 2 44}
#endif

        {VARIABLE stop_saurians yes}
        {VARIABLE dream_sequence 0}
        {CLEAR_VARIABLE protector_awake}

#ifdef HARD
        {MODIFY_TERRAIN Uu 2 44}
        {MODIFY_TERRAIN Uh 3 44}
#endif
#ifdef NORMAL
        {MODIFY_TERRAIN Uh 3 44}
#endif
#ifdef EASY #allow the player to easily defeat the Eyestalk on Easy
        {MODIFY_TERRAIN Uu^Es 18 34}
        {MODIFY_TERRAIN Uu 19 35}
#endif
        
        [recall]
            id=Toruk
            x,y=3,43
            facing=se
        [/recall]
        [recall]
            id=Stuurg
            x,y=2,42
            facing=se
        [/recall]

        [unit] #todo: maybe nerf a little if the player doesn't have some decent melee units?
            type=Eyestalk
            x,y=17,35
            facing=se
            side=3
        [/unit]

        [objectives]

            [objective]
                description= _ "Explore the deep tunnels"
                condition=win
                [show_if]
                    [variable]
                        name=dream_sequence
                        equals=0
                    [/variable]
                [/show_if]
            [/objective]

            [objective]
                description= _ "Move Arshag to the fortress"
                condition=win
                [show_if]
                    [variable]
                        name=dream_sequence
                        equals=1
                    [/variable]
                [/show_if]
            [/objective]

            [objective]
                description= _ "Defeat enemies in the first dream"
                condition=win
                [show_if]
                    [variable]
                        name=dream_sequence
                        equals=2
                    [/variable]
                [/show_if]
            [/objective]

            [objective]
                description= _ "Defeat enemies in the second dream"
                condition=win
                [show_if]
                    [variable]
                        name=dream_sequence
                        equals=3
                    [/variable]
                [/show_if]
            [/objective]

            [objective]
                description= _ "Any of your units reaches the gate"
                condition=win
                [show_if]
                    [variable]
                        name=dream_sequence
                        equals=4
                    [/variable]
                [/show_if]
            [/objective]

            [objective]
                description= _ "Fight through the saurians to reach the gate"
                condition=win
                [show_if]
                    [variable]
                        name=fortress_visited
                        equals=yes
                    [/variable]
                    [and]
                        [have_unit]
                            side=2
                        [/have_unit]
                    [/and]
                    [and]
                        [variable]
                            name=dream_sequence
                            less_than=4
                        [/variable]
                    [/and]
                [/show_if]
            [/objective]

            [objective]
                description= _ "Death of Arshag"
                condition=lose
            [/objective]

            [objective]
                description= _ "Death of Stuurg"
                condition=lose
            [/objective]

            [objective]
                description= _ "Death of Toruk"
                condition=lose
                [show_if]
                    [have_unit]
                        id=Toruk
                    [/have_unit]
                [/show_if]
            [/objective]

            [note]
#ifdef EASY
                description="You can recall or recruit up to 4 units, but only during the first turn."
#endif
#ifdef NORMAL
                description="You can recall or recruit up to 3 units, but only during the first turn."
#endif
#ifdef HARD
                description="You can recall or recruit up to 2 units, but only during the first turn."
#endif
                [show_if]
                    [variable]
                        name=turn_number
                        equals=1
                    [/variable]
                [/show_if]
            [/note]

            [note]
                description="Stuurg may save either Arshag or Toruk from fading away if he stays in the fortress, but only once."
                [show_if]
                    [variable]
                        name=stuurg_heal_used
                        not_equals=yes
                    [/variable]
                    [and]
                        [variable]
                            name=dream_sequence
                            greater_than=1
                        [/variable]
                    [/and]
                    [and]
                        [variable]
                            name=dream_sequence
                            less_than=4
                        [/variable]
                    [/and]
                [/show_if]
            [/note]

            {TURNS_RUN_OUT}

            [gold_carryover]
                carryover_percentage=0
                bonus=no
            [/gold_carryover]

        [/objectives]

    [/event]

    [event]
        name=start

        [message]
            speaker=Stuurg
            image_pos=right
            message= _ "The stones' whispers say there's a path ahead that leads to the surface."
        [/message]

        [message]
            speaker=Arshag
            image_pos=right
            message= _ "What do you know about this path?"
        [/message]

        [message]
            speaker=Stuurg
            image_pos=right
            message= _ "Not a lot. Just that there's a gate we need to open.

I've never been this far down, nor has anyone I've known."
        [/message]

        {COND_SAY_R curse_lifted Toruk "We should get going then. We're running low on supplies, so there's little time to waste." "We should get going then. The undead are probably still following us."}

        [message]
            speaker=narrator
            image=wesnoth-icon.png
            message= _ "You may recruit or recall some units, but only during the first turn."
        [/message]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x,y=6,42
        [/filter]
        
        {GENERIC_UNIT 3 (Giant Rat) 5 43}
        {GENERIC_UNIT 3 (Giant Rat) 7 43}

        {VARIANT_SAY "Empty. Only rats now. People no here no more." "It'sss empty, all that'sss left isss sssome vermin. Whoever lived here isss long gone." "Just some rats. Nobody else home." "It's empty, all that's left is some vermin. Whoever lived here is long gone."}
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x,y=12,43
        [/filter]
        
        {GENERIC_UNIT 3 (Giant Rat) 11 44}
#ifdef EASY
        {GENERIC_UNIT 3 (Blood Bat) 13 44}
#else
        {GENERIC_UNIT 3 (Dread Bat) 13 44}
#endif
    [/event]

    [event]
        name=sighted
        [filter]
            type=Eyestalk
        [/filter]
        [filter_second]
            side=1
        [/filter_second]

        [message]
            speaker=Toruk
            message= _ "What is this abomination?"
        [/message]

        [if] #bow gift easter egg
            [have_unit]
                side=1
                [filter_wml]
                    [modifications]
                        [object]
                            id=bow_gift
                        [/object]
                    [/modifications]
                [/filter_wml]
            [/have_unit]

            [then]
                [message]
                    speaker=Stuurg
                    message= _ "I heard about this creature.

Avoid its eye. It could be the last thing you see."
                [/message]

                [message]
                    speaker=Arshag
                    message= _ "Can't we just shoot that eye out?"
                [/message]

                [message]
                    role=Gift User
                    message= _ "It won't work with a stupid crossbow, it only shoots straight. But I have this great bow we made for the dwarves.

Let me try."
                [/message]

                [move_unit] #if there's some other unit, remove it so the animation looks right
                    x,y=21,37
                    to_x=20
                    to_y=37
                [/move_unit]

                [move_unit]
                    role=Gift User
                    to_x=21
                    to_y=37
                [/move_unit]

                [message]
                    speaker=narrator
                    image=wesnoth-icon.png
                    message= _ "The orc archer hides behind a large rock and watches the eyestalk for a while. His smaller eyes swivel and tilt, often covering the largest eye. But the orc knows he can shoot in an arc, so the arrow flies over the tentacular outgrowth and hits the target."
                [/message]

                [animate_unit]
                    flag=attack
                    [filter]
                        role=Gift User
                    [/filter]
                    [facing]
                        x,y=20,36
                    [/facing]
                    [primary_attack]
                        range=ranged
                    [/primary_attack]
                    hits=yes
                [/animate_unit]

                [move_unit_fake]
                    type=RTL Arrow
                    side=1
                    x=20,17
                    y=36,35
                [/move_unit_fake]

                [kill]
                    type=Eyestalk
                    animate=yes
                [/kill]

                [message]
                    role=Gift User
                    message= _ "See? Easy!"
                [/message]

                [object]
                    id=bow_upgrade
                    description= _ "Your best orcish bowman learned how to hit distant targets accurately."
                    silent=yes
                    duration=forever
                    [filter]
                        role=Gift User
                    [/filter]
                    [effect]
                        apply_to=new_attack
                        name=bow
                        description= _ "precise shot"
                        icon=attacks/gaze.png
                        type=pierce
                        range=ranged
                        damage=25
                        number=1
                        [specials]
                            {WEAPON_SPECIAL_MARKSMAN}
                        [/specials]
                    [/effect]
                [/object]

                [set_achievement]
                    content_for=RTL_SP
                    id=RTL_bullseye
                [/set_achievement]

            [/then]
        [/if]

    [/event]

    [event]
        name=turn 2
        {MODIFY_TERRAIN Ur 2 43}
        {MODIFY_TERRAIN Uu 1 43}
        {MODIFY_TERRAIN Ur 1 44}
        {MODIFY_TERRAIN Uu 2 44}
        {MODIFY_TERRAIN Uh 3 44}
        [remove_item]
            x,y=2,43
        [/remove_item]
        [remove_item]
            x,y=1,43
        [/remove_item]
        [remove_item]
            x,y=1,44
        [/remove_item]
        [remove_item]
            x,y=2,44
        [/remove_item]
        [remove_item]
            x,y=3,44
        [/remove_item]
    [/event]

    [event]
        name=turn 4

        [filter_condition]
            [variable]
                name=curse_lifted
                not_equals=yes
            [/variable]
        [/filter_condition]

        {GENERIC_UNIT 4 (Shadow) 1 43}
#ifdef EASY
        {GENERIC_UNIT 4 (Deathblade) 1 42}
#else
        {GENERIC_UNIT 4 (Draug) 1 42}
#endif
#ifdef HARD
        {GENERIC_UNIT 4 (Banebow) 1 44}
#else
        {GENERIC_UNIT 4 (Bone Shooter) 1 44}
#endif

        [message]
            speaker=Toruk
            message= _ "Arshag, the undead have caught up with us!"
        [/message]
    [/event]

    [event]
        name=turn 7

        [filter_condition]
            [variable]
                name=curse_lifted
                not_equals=yes
            [/variable]
        [/filter_condition]

        {GENERIC_UNIT 4 (Wraith) 1 43}
#ifdef EASY
        {GENERIC_UNIT 4 (Shadow) 1 42}
#else
        {GENERIC_UNIT 4 (Nightgaunt) 1 42}
#endif
        {GENERIC_UNIT 4 (Chocobone) 1 44}

        [scroll_to]
            x,y=1,43
        [/scroll_to]
    [/event]

    [event]
        name=turn 4

        [filter_condition]
            [variable]
                name=curse_lifted
                equals=yes
            [/variable]
        [/filter_condition]

        {GENERIC_UNIT 3 (Dread Bat) 19 34}
#ifdef EASY
        {GENERIC_UNIT 3 (Vampire Bat) 12 35}
#else
        {GENERIC_UNIT 3 (Blood Bat) 12 35}
#endif
#ifdef HARD
        {GENERIC_UNIT 3 (Dread Bat) 24 37}
#else
        {GENERIC_UNIT 3 (Blood Bat) 24 37}
#endif
    [/event]

    [event]
        name=new turn
        first_time_only=no

        [modify_unit]
            [filter]
                x=5,19,12,3,10,5,10,9,10,4
                y=44,37,27,28,22,19,14,9,4,5
            [/filter]
            [object]
                duration=turn end
                [effect]
                    apply_to=attack
                    range=melee
                    [set_specials]
                        mode=append
                        {WEAPON_SPECIAL_DRAIN}
                    [/set_specials]
                [/effect]
            [/object]
        [/modify_unit]
    [/event]

    [event]
        name=moveto
        [filter]
            side=1
            x=5,19,12,3,10,5,10,9,10,4
            y=44,37,27,28,22,19,14,9,4,5
        [/filter]
        {VARIANT_SAY "When me touch this rock, it <i>drains</i> me." "When I touch thisss ssstone... it sssomehow feelsss like it <i>drainsss</i> me." "When I touch this rock, it <i>drains</i> me." "When I touch this stone... it somehow feels like it <i>drains</i> me."}
        {HINT_STONE}
    [/event]

    [event]
        name=moveto

        [filter]
            side=1
            x="9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29"
            y="28-29,27-29,27-30,27-29,28-31,28-30,27-32,26-31,26-31,25-30,26-31,25-30,26-30,26-30,26-30,25-30,25-31,25-30,26-30,26-30,27-30"
        [/filter]

        [remove_shroud]
            x="9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29"
            y="28-29,27-29,27-30,27-29,28-31,28-30,27-32,26-31,26-31,25-30,26-31,25-30,26-30,26-30,26-30,25-30,25-31,25-30,26-30,26-30,27-30"
        [/remove_shroud]

        [redraw][/redraw]
            
        {VARIANT_SAY "Big cave ahead." "Thisss cave isss huge! Isss it a fortresss there in the back?." "A big cave! Is there a fortress back there?" "This cave is huge! Is it a fortress there in the back?"}

        [message]
            speaker=Arshag
            message= _ "It looks dwarvish, but much older than their buildings on the surface."
        [/message]

        {IF_WOLF_SAY "<i>Arshag's wolf walks through dark tunnels as if in a dream. The distant fortress seems to have a strangely numbing effect on him.</i>"}

        [message]
            speaker=Stuurg
            message= _ "If my inner sight is right, we might be the last to enter.

As will our tunnels above, so will these halls soon fall and break."
        [/message]

        [message]
            type_adv_tree=Ghost
            side=1
            message= _ "I feel an unknown force pulling me to the fortress. It threatens to overwhelm me."
        [/message]

        {HIGHLIGHT_IMAGE 28 28 items/gohere.png (items/altar-evil.png)}
        
        {VARIABLE dream_sequence 1}

        [show_objectives]
        [/show_objectives]

        {GENERIC_UNIT 2 (Saurian Ambusher) 7 27} {SAURIAN_GUARD 7,27}
        [modify_unit]
            [filter]
                x,y=7,27
            [/filter]
            [object]
                [effect]
                    apply_to=movement
                    set=5
                [/effect]
            [/object]
        [/modify_unit]

        {GENERIC_UNIT 2 (Saurian Ambusher) 4 23} {SAURIAN_GUARD 4,23}
        {GENERIC_UNIT 2 (Saurian Spearthrower) 4 24} {SAURIAN_GUARD 4,24}
        {GENERIC_UNIT 2 (Saurian Spearthrower) 6 22} {SAURIAN_GUARD 6,22}
        {GENERIC_UNIT 2 (Saurian Spearthrower) 8 12} {SAURIAN_GUARD 8,12}
        {GENERIC_UNIT 2 (Saurian Ambusher) 9 12} {SAURIAN_GUARD 9,12}
        {GENERIC_UNIT 2 (Saurian Soothsayer) 7 12} {SAURIAN_GUARD 7,12}
        {GENERIC_UNIT 2 (Saurian Soothsayer) 8 11} {SAURIAN_GUARD 8,11}
        {GENERIC_UNIT 2 (Saurian Spearthrower) 9 11} {SAURIAN_GUARD 9,11}
        {GENERIC_UNIT 2 (Saurian Ambusher) 8 6} {SAURIAN_GUARD 8,6}
        {GENERIC_UNIT 2 (Saurian Ambusher) 9 7} {SAURIAN_GUARD 9,7}
#ifdef EASY
        {GENERIC_UNIT 2 (Saurian Soothsayer) 8 7} {SAURIAN_GUARD 8,7}
#else
        {GENERIC_UNIT 2 (Saurian Seer) 8 7} {SAURIAN_GUARD 8,7}
#endif
        {VARIABLE stop_saurians no}

    [/event]

    [event]
        name=moveto

        [filter]
            id=Arshag
            x,y=28,28
        [/filter]

        [remove_item]
            x,y=28,28
        [/remove_item]

        {PLACE_IMAGE (items/altar-evil.png) 28 28}

        {MOVE_UNIT id=Arshag 27 29}
        [modify_unit]
            [filter]
                id=Arshag
            [/filter]
            facing=ne
        [/modify_unit]
        {MOVE_UNIT id=Stuurg 26 28}
        [modify_unit]
            [filter]
                id=Stuurg
            [/filter]
            facing=ne
        [/modify_unit]
        {MOVE_UNIT id=Toruk 27 28}
        [modify_unit]
            [filter]
                id=Toruk
            [/filter]
            facing=se
        [/modify_unit]

        [message]
            speaker=Arshag
            message= _ "Who's there?"
        [/message]

        [unit]
            name=Nale
            id=Nale
            type=Saurian Spearthrower
            x,y=28,28
            side=1
            facing=sw
            hitpoints=3
        [/unit]

        [hide_unit]
            id=Nale
        [/hide_unit]

        {PLACE_IMAGE ("units/saurians/spearthrower/spearthrower-se-die1.png~FL()~RC(magenta>red)") 28 28}

        [message]
            speaker=Nale
            message= _ "Itsss me. My name isss Nale."
        [/message]

        [message]
            speaker=Stuurg
            message= _ "A saurian! I didn't think we would find one so deep down."
        [/message]

        [message]
            speaker=Nale
            message= _ "My tribe wasss trapped here while ssscavenging. There isss a gate further along that closssed right behind usss."
        [/message]

        [remove_shroud]
            x="5,6,7"
	        y="2,1-2,2"
        [/remove_shroud]

        [redraw][/redraw]

        [scroll_to]
            x,y=6,1
        [/scroll_to]

        [delay]
            time=1500
        [/delay]

        [message]
            speaker=Toruk
            message= _ "She's wounded! Can we help her?"
        [/message]

        [message]
            speaker=Stuurg
            message= _ "Those are spear marks. Her wounds are very deep.

I fear there is nothing I can do."
        [/message]

        [message]
            speaker=Nale
            message= _ "Then lisssten while I ssstil draw breath, ssso my death isssn't in vain.
            
You'll meet my tribe if you continue through the tunelsss. They're feral and can't be reassoned with."
        [/message]

        [message]
            speaker=Nale
            message= _ "They ate the mussshroomsss that grow here and it consssumed their mindsss. Their eyess turned empty and their ssskin grew red.
            
I sssurvived on the batsss and other creaturess, but my tribe now attacks me on sssight!"
        [/message]

        [message]
            speaker=Arshag
            message= _ "And what about this fortress? Do you know anything about it?"
        [/message]

        [message]
            speaker=Nale
            message= _ "When I fall asssleep here, I get ssstrange dreamsss.
            
I sssee facesss I know, even thossse of the dead."
        [/message]

        [delay]
            time=500
        [/delay]

        [message]
            speaker=Nale
            message= _ "Now they're coming again to take me away with them."
        [/message]

        [delay]
            time=500
        [/delay]

        [message]
            speaker=Arshag
            message= _ "Nale?"
        [/message]

        [unhide_unit]
            id=Nale
        [/unhide_unit]

        [remove_item]
            x,y=28,28
        [/remove_item]

        {PLACE_IMAGE (items/altar-evil.png) 28 28}

        [kill]
            id=Nale
            animate=yes
        [/kill]

        [modify_unit]
            [filter]
                id=Toruk
            [/filter]
            facing=sw
        [/modify_unit]

        [message]
            speaker=Toruk
            message= _ "What do you make of this, Stuurg?"
        [/message]

        [message]
            speaker=Stuurg
            message= _ "I can feel something coming from the abyss. A power tied to the cold stone.
            
A force so vast I've never felt anything like it."
        [/message]

        [delay]
            time=1000
        [/delay]

        [modify_unit]
            [filter]
                id=Arshag
            [/filter]
            facing=nw
        [/modify_unit]

        [message]
            speaker=Arshag
            message= _ "I want to sleep in this fortress."
        [/message]

        [message]
            speaker=Toruk
            message= _ "Arshag, are you sure this is a good idea?"
        [/message]

        [message]
            speaker=Arshag
            message= _ "It could be the key to reopening the gate Nale mentioned."
        [/message]

        [message]
            speaker=Arshag
            message= _ {WHISPER _"Besides, Toruk, I don't really know what to do anymore. We die one by one on this strange continent and I'm powerless to stop it.
            
Maybe the dead hold wisdom I need, if this is really a way to commune with them."}
        [/message]

        [message]
            speaker=Toruk
            message= _ "All right, but I'm going with you."
        [/message]

        [message]
            speaker=Stuurg
            message= _ "Alright. We'll head for the gate in the meantime.

I can stay in the fortress to keep an eye on you."
        [/message]

        {VARIABLE fortress_visited yes}

        [store_unit]
            [filter]
                id=Arshag
            [/filter]
            variable=arshag_store
        [/store_unit]

        [store_unit]
            [filter]
                id=Toruk
            [/filter]
            variable=toruk_store
        [/store_unit]

        [kill]
            id=Arshag,Toruk
            animate=no
        [/kill]
        
        [remove_shroud]
            x="16,17,17,18,19,20,21,22,23,24,25,26,27,28,29"
            y="13-22,0-3,13-23,0-23,0-23,0-23,0-24,0-23,0-23,0-23,0-23,0-22,0-23,0-22,0-22"
        [/remove_shroud]

        {MOVE_UNIT id=Stuurg 28 28}
        {MAKE_LOYAL_LEADER (Stuurg)}
        [if]
            [variable]
                name=arshag_store.type
                equals=Orcish Assassin
            [/variable]
            [or]
                [variable]
                    name=arshag_store.type
                    equals=RTL Mounted Assassin
                [/variable]
            [/or]
            [then]
                [unit]
                    id=Arshag_Ghost
                    name=Arshag
                    type=RTL Ghost Orcish Assassin
                    x,y=21,24
                    facing=ne
                    side=1
                    canrecruit=yes
                [/unit]
            [/then]
            [elseif]
                [variable]
                    name=arshag_store.type
                    equals=Orcish Slayer
                [/variable]
                [or]
                    [variable]
                        name=arshag_store.type
                        equals=RTL Mounted Slayer
                    [/variable]
                [/or]
                [then]
                    [unit]
                        id=Arshag_Ghost
                        name=Arshag
                        type=RTL Ghost Orcish Slayer
                        profile="portraits/arshag.webp~O(70%)~GS()~CS(-200,-40,-0)"
                        x,y=21,24
                        facing=ne
                        side=1
                        canrecruit=yes
                    [/unit]
                [/then]
            [/elseif]
            [else]
                [unit]
                    id=Arshag_Ghost
                    name=Arshag
                    type=RTL Ghost Orcish Nightblade
                    x,y=21,24
                    facing=ne
                    side=1
                    canrecruit=yes
                [/unit]
            [/else]
        [/if]

        [if]
            [variable]
                name=toruk_store.type
                equals=RTL Old Grunt
            [/variable]
            [then]
                [unit]
                    id=Toruk_Ghost
                    name=Toruk
                    type=RTL Ghost Old Grunt
                    x,y=23,24
                    facing=nw
                    side=1
                    [modifications]
                        {TRAIT_LOYAL}
                    [/modifications]
                [/unit]
            [/then]
            [else]
                [unit]
                    id=Toruk_Ghost
                    name=Toruk
                    type=RTL Ghost Orcish Veteran
                    x,y=23,24
                    facing=nw
                    side=1
                    [modifications]
                        {TRAIT_LOYAL}
                    [/modifications]
                [/unit]
            [/else]
        [/if]

        [if]
            [variable]
                name=first_event
                equals=1
            [/variable]
            [then]
            [/then]
            [else]
                {VARIABLE first_event 2}
            [/else]
        [/if]

        [if]
            [variable]
                name=arshag_angry
#ifdef HARD
                greater_than_equal_to=6
#else
                greater_than_equal_to=8
#endif
            [/variable]

            [then]
                {VARIABLE first_event 3}
            [/then]
        [/if]

        [switch]
            variable=first_event

            [case]
                value=1 #Morvin encounter
                [terrain_mask]
                    x,y=17,18
                    alignment=raw
                    mask="_f, _f, _f, _f, _f, Hh, _f, _f, _f, _f, _f
                    _f, _f, _f, Gg^Fds, Gg^Fds, Hh, Hh, Gs^Gvs, _f, _f, _f
                    _f, Gg^Em, Re, Re, Gs^Fds, Gg^Em, Gg^Es, Gs^Wm, Gs^Gvs, Gg^Fds, _f
                    _f, Gg^Fds, Hh, Gs^Es, Re, Re, Gg^Gvs, Gs^Em, Gs^Fds, Gg^Fds, _f
                    _f, Gg^Fds, Hh^Fds, Gs^Fds, Gs^Efm, Re, Gg^Efm, Gg^Efm, Hh^Fds, Hh, _f
                    _f, _f, Gg^Fds, Hh, Hh, Re, Gg, Gg^Efm, Hh, _f, _f
                    _f, _f, _f, _f, Gg^Efm, Re, Gg^Es, _f, _f, _f, _f"
                [/terrain_mask]
                [time_area]
                    id=firstdream_ta
                    {MORNING}
                    x="18,19,20,21,22,23,24,25,26"
                    y="20-22,20-23,19-23,19-24,18-24,19-24,19-23,20-23,20-22"
                [/time_area]
#ifdef HARD
                {GHOST_UNIT Mage 22 18 morv_enc}
#else
                {GHOST_UNIT Bowman 22 18 morv_enc}
                {GHOST_UNIT Spearman 19 21 morv_enc}
#endif
#ifdef EASY
                {GHOST_UNIT Peasant 24 20 morv_enc}
#endif
#ifdef NORMAL
                {GHOST_UNIT Bowman 24 20 morv_enc}
#endif
#ifdef HARD
                {GHOST_UNIT Fencer 24 20 morv_enc}
#endif 
                {GHOST_UNIT Cavalryman 19 20 morv_enc}
            [/case]
            [case]
                value=2 #Birmaglost encounter
                [terrain_mask]
                    x,y=17,18
                    alignment=raw
                    mask="_f, _f, _f, _f, _f, Re^Esa, _f, _f, _f, _f, _f, _f, _f, _f, _f
                    _f, _f, _f, Mm^Es, Re^Esa, Mm^Xm, Ms, Ms, _f, _f, _f, _f, _f, _f, _f
                    _f, Hh^Es, Wo, Wo, Re^Esa, Mm, Mm, Mm, Mm, Hh^Fms, _f, _f, _f, _f, _f
                    _f, Ww, Wo, Ss, Ww, Ww, Mm, Hh^Esa, Hh^Fms, Gs^Fms, _f, _f, _f, _f, _f
                    _f, Sm, Ss, Cf^Edt, Ss, Ss, Wwr, Gs^Edt, Gd^Es, Gd^Fms, _f, _f, _f, _f, _f
                    _f, _f, Sm, Ss, Ss, Ss^Bw/r, Ww^Bw/r, Ww, Gd^Es, _f, _f, _f, _f, _f, _f
                    _f, _f, _f, _f, Ss, Ss, Ss, _f, _f, _f, _f, _f, _f, _f, _f"
                [/terrain_mask]
                [time_area]
                    id=firstdream_ta
                    {AFTERNOON}
                    x="18,19,20,21,22,23,24,25,26"
                    y="20-22,20-23,19-23,19-24,18-24,19-24,19-23,20-23,20-22"
                [/time_area]
#ifdef HARD
                {GHOST_UNIT "Dwarvish Thunderguard" 23 20 birm_enc}
#else
                {GHOST_UNIT "Dwarvish Thunderer" 23 20 birm_enc}
#endif
                {GHOST_UNIT "Dwarvish Guardsman" 20 22 birm_enc}
                {GHOST_UNIT "Dwarvish Scout" 26 20 birm_enc}
#ifdef EASY
#else
                {GHOST_UNIT "Dwarvish Fighter" 20 19 birm_enc}
#endif
            [/case]
            [case]
                value=3 #Orc encounter
                [terrain_mask]
                    x,y=17,18
                    alignment=raw
                    mask="_f, _f, _f, _f, _f, Rd^Es, _f, _f, _f, _f, _f, _f, _f, _f, _f
                    _f, _f, _f, Re^Es, Rb^Edt, Rb, Hhd^Esd, Hhd^Es, _f, _f, _f, _f, _f, _f, _f
                    _f, Hhd, Re^Esd, Rd, Rd, Ket, Rd^Edb, Hhd, Re, Rd, _f, _f, _f, _f, _f
                    _f, Hhd^Esd, Hhd, Ket, Re^Edb, Re, Rd, Re^Edt, Rd^Esd, Rd, _f, _f, _f, _f, _f
                    _f, Rd, Rd^Edt, Rd^Es, Re, Ket, Rb^Es, Md, Rd, Hhd^Es, _f, _f, _f, _f, _f
                    _f, _f, Rb, Rb^Esd, Rd, Rd^Edb, Hhd, Hhd^Esd, Hhd^Esd, _f, _f, _f, _f, _f, _f
                    _f, _f, _f, _f, Rd, Rb, Hhd, _f, _f, _f, _f, _f, _f, _f, _f"
                [/terrain_mask]
                [time_area]
                    id=firstdream_ta
                    {FIRST_WATCH}
                    x="18,19,20,21,22,23,24,25,26"
                    y="20-22,20-23,19-23,19-24,18-24,19-24,19-23,20-23,20-22"
                [/time_area]
#ifdef HARD
                {GHOST_UNIT "Troll Rocklobber" 20 19 orc_enc}
#else
                {GHOST_UNIT "Orcish Warrior" 20 19 orc_enc}
#endif
                {GHOST_UNIT "Wolf Rider" 21 23 orc_enc}
                {GHOST_UNIT "Orcish Archer" 22 18 orc_enc}
#ifdef EASY
#else
                {GHOST_UNIT "Troll Whelp" 26 20 orc_enc}
#endif
                [message]
                    speaker=Toruk_Ghost
                    message= _ "This is our old home far in the east!"
                [/message]
                [message]
                    speaker=Arshag_Ghost
                    message= _ "More like an illusion of it. Those orcs don't look very friendly."
                [/message]
            [/case]
        [/switch]

        [redraw]
            clear_shroud=yes
        [/redraw]
        
        {VARIABLE dream_sequence 2}

        [show_objectives]
        [/show_objectives]
    [/event]

    [event]
        name=second_encounter

        [modify_unit]
            [filter]
                id=Arshag_Ghost
            [/filter]
            attacks_left=1
            moves=6
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Toruk_Ghost
            [/filter]
            attacks_left=1
            moves=5
        [/modify_unit]

        [if]
            [variable]
                name=second_event
                equals=1
            [/variable]
            [then]
            [/then]
            [else]
                {VARIABLE second_event 2}
            [/else]
        [/if]
        
        [switch]
            variable=second_event

            [case]
                value=1 #Logalmier encounter
                [terrain_mask]
                    x,y=19,11
                    alignment=raw
                    mask="_f, _f, _f, _f, _f, Gg^Efm, _f, _f, _f, _f, _f, _f, _f
                    _f, _f, _f, Gg^Efm, Gs^Fds, Kv, Re, Gs^Fds, _f, _f, _f, _f, _f
                    _f, Gs^Fds, Gs^Fds, Gs^Fds, Gg^Es, Re, Re, Gs^Fds, Gs^Fds, Gs^Fds, _f, _f, _f
                    _f, Gs^Fdf, Gs^Fds, Gg^Fet, Re, Gg^Em, Gs^Fds, Gg^Efm, Gs^Fdf, Gs^Fds, _f, _f, _f
                    _f, Gg^Efm, Gs^Fds, Gs^Fds, Re, Re, Gg^Efm, Gg^Fet, Gs^Fds, Gs^Fds, _f, _f, _f
                    _f, _f, Gg, Gg^Em, Gg^Es, Re, Gs^Fds, Gs^Fds, Gg^Em, _f, _f, _f, _f
                    _f, _f, _f, _f, Gs^Efm, Re, Gs^Fds, _f, _f, _f, _f, _f, _f"
                [/terrain_mask]
                [time_area]
                    id=seconddream_ta
                    {DAWN}
                    x="20,21,22,23,24,25,26,27,28"
	                y="13-15,13-16,12-16,12-17,11-17,12-17,12-16,13-16,13-15"
                [/time_area]
#ifdef HARD
                {GHOST_UNIT "Elvish Captain" 25 14 loga_enc}
#else
                {GHOST_UNIT "Elvish Hero" 25 14 loga_enc}
#endif
                {GHOST_UNIT "Elvish Archer" 22 14 loga_enc}
                {GHOST_UNIT "Elvish Shaman" 23 12 loga_enc}
#ifdef EASY
                {GHOST_UNIT "Elvish Fighter" 20 14 loga_enc}
#else
                {GHOST_UNIT "Elvish Archer" 20 14 loga_enc}
#endif
            [/case]
            [case]
                value=2 #Zofaria encounter
                [terrain_mask]
                    x,y=19,11
                    alignment=raw
                    mask="_f, _f, _f, _f, _f, Gd^Es, _f, _f, _f, _f, _f, _f, _f
                    _f, _f, _f, Gd^Es, Gll^Fdw, Kvr, Rd^Edb, Gll^Fdw, _f, _f, _f, _f, _f
                    _f, Gll^Fdw, Gll^Fdw, Gll^Fdw, Gd^Edb, Rd^Edt, Rd, Gll^Fdw, Gll^Fdw, Gll^Fdw, _f, _f, _f
                    _f, Gs^Fdf, Gll^Fdw, Gd^Fetd, Rd, Gd^Es, Gll^Fdw, Gd^Edt, Gs^Fdf, Gll^Fdw, _f, _f, _f
                    _f, Gd, Gll^Fdw, Gll^Fdw, Rd, Rd^Edb, Gd, Gd^Fetd, Gll^Fdw, Gll^Fdw, _f, _f, _f
                    _f, _f, Gd^Edt, Gd^Es, Gd^Edt, Rd, Gll^Fdw, Gll^Fdw, Gd^Edb, _f, _f, _f, _f
                    _f, _f, _f, _f, Gd^Edb, Rd, Gll^Fdw, _f, _f, _f, _f, _f, _f"
                [/terrain_mask]
                [time_area]
                    id=seconddream_ta
                    {MIDNIGHT}
                    x="20,21,22,23,24,25,26,27,28"
	                y="13-15,13-16,12-16,12-17,11-17,12-17,12-16,13-16,13-15"
                [/time_area]
#ifdef HARD
                {GHOST_UNIT "Elvish Captain" 25 14 zofa_enc}
#else
                {GHOST_UNIT "Elvish Hero" 25 14 zofa_enc}
#endif
                {GHOST_UNIT "Elvish Archer" 22 14 zofa_enc}
                {GHOST_UNIT "Elvish Shaman" 23 12 zofa_enc}
#ifdef EASY
                {GHOST_UNIT "Elvish Fighter" 20 14 zofa_enc}
#else
                {GHOST_UNIT "Elvish Archer" 20 14 zofa_enc}
#endif
            [/case]
        [/switch]

        {VARIABLE dream_sequence 3}

        [show_objectives]
        [/show_objectives]
    [/event]

    [event]
        name=third_encounter

        [if]
            [not]
                [have_unit]
                    id=Toruk_Ghost
                [/have_unit]
            [/not]
            [or]
                [variable]
                    name=arshag_angry
#ifdef HARD
                    greater_than_equal_to=6
#else
                    greater_than_equal_to=8
#endif
                [/variable]
            [/or]
            [then]
                [set_variable]  
                    name=third_event
                    value=1
                [/set_variable]
            [/then]
            [else]
                [set_variable]  
                    name=third_event
                    value=2
                [/set_variable]
            [/else]
        [/if]

        [switch]
            variable=third_event

            [case]
                value=1 #Toruk's Death
                [terrain_mask]
                    x,y=19,2
                    alignment=raw
                    mask="_f, _f, _f, _f, _f, Gg^Es, _f, _f, _f, _f, _f, _f, _f
                    _f, _f, _f, Gg^Efm, Gg^Efm, Gg, Gs, Gs, _f, _f, _f, _f, _f
                    _f, Hh, Hh, Gg, Gs^Efm, Gg, Gg, Ww, Ww^Es, Hh, _f, _f, _f
                    _f, Ww, Gg, Wo, Wo, Wwf, Wwf^Es, Gg, Gg, Hh, _f, _f, _f
                    _f, Gg, Ww, Gg, Gg^Es, Gg, Gg, Gs, Gg^Efm, Gg^Efm, _f, _f, _f
                    _f, _f, Gg^Es, Hh, Gg, Gs, Gs, Gg^Es, Gg^Efm, _f, _f, _f, _f
                    _f, _f, _f, _f, Hh, Gg, Gg, _f, _f, _f, _f, _f, _f"
                [/terrain_mask]
                [time_area]
                    id=thirddream_ta
                    {DUSK}
                    x="20,21,22,23,24,25,26,27,28"
	                y="4-6,4-7,3-7,3-8,2-8,3-8,3-7,4-7,4-6"
                [/time_area]

                {INCIDENTAL_MUSIC journeys_end.ogg}

                [message]
                    speaker=Arshag_Ghost
                    message= _ "This dream is... empty?"
                [/message]

                [if]
                    [variable]
                        name=arshag_angry
#ifdef HARD
                        greater_than_equal_to=6
#else
                        greater_than_equal_to=8
#endif
                    [/variable]
                    [and]
                        [have_unit]
                            id=Toruk_Ghost
                        [/have_unit]
                    [/and]
                    [then]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "I think this is my dream."
                        [/message]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "It's <i>so beautiful.</i>"
                        [/message]
                        [scroll_to]
                            x,y=24,2
                        [/scroll_to]
                        [message]
                            speaker=Arshag_Ghost
                            message= _ "Toruk? What is this place?"
                        [/message]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "Our new home."
                        [/message]
                        [delay]
                            time=2000
                        [/delay]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "It was my one wish to see it before I die."
                        [/message]
                        [delay]
                            time=1000
                        [/delay]
                        [message]
                            speaker=Arshag_Ghost
                            message= _ "Toruk!"
                        [/message]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "Warlord's blade hit me deeper than I thought. My body is dying.

I'll never wake up from this dream."
                        [/message]
                        [message]
                            speaker=Arshag_Ghost
                            message= _ "It was me who brought us here.

How can I hope not to kill everyone else as I have killed you?"
                        [/message]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "You have a new vision for what orcs may one day become. I believe it.
                            
Don't be discouraged if you stumble along the way."
                        [/message]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "Now go. Let me enjoy this last sunset."
                        [/message]

                        [kill]
                            id=Toruk_Ghost
                            animate=no
                        [/kill]
                        [kill]
                            id=Arshag_Ghost
                            animate=no
                        [/kill]
                    [/then]
                    [else]
                        [if]
                            [variable]
                                name=toruk_store.type
                                equals=RTL Old Grunt
                            [/variable]
                            [then]
                                [unit]
                                    id=Toruk_Ghost
                                    name=Toruk
                                    type=RTL Ghost Old Grunt
                                    x,y=25,8
                                    facing=nw
                                    side=1
                                    [modifications]
                                        {TRAIT_LOYAL}
                                    [/modifications]
                                [/unit]
                            [/then]
                            [else]
                                [unit]
                                    id=Toruk_Ghost
                                    name=Toruk
                                    type=RTL Ghost Orcish Veteran
                                    x,y=25,8
                                    facing=nw
                                    side=1
                                    [modifications]
                                        {TRAIT_LOYAL}
                                    [/modifications]
                                [/unit]
                            [/else]
                        [/if]

                        [message]
                            speaker=Toruk_Ghost
                            message= _ "I think this is my dream."
                        [/message]
                        [message]
                            speaker=Arshag_Ghost
                            message= _ "Toruk! You're back!"
                        [/message]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "It's <i>so beautiful.</i>"
                        [/message]
                        [scroll_to]
                            x,y=24,2
                        [/scroll_to]
                        [message]
                            speaker=Arshag_Ghost
                            message= _ "Toruk? What is this place?"
                        [/message]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "Our new home."
                        [/message]
                        [delay]
                            time=2000
                        [/delay]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "It was my one wish to see it before I die."
                        [/message]
                        [delay]
                            time=1000
                        [/delay]
                        [message]
                            speaker=Arshag_Ghost
                            message= _ "I need you Toruk. I can't do this alone.

I don't even know who I am anymore."
                        [/message]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "I didn't know it for most of my life.
                            
Now I do, Arshag. Thanks to you."
                        [/message]
                        [message]
                            speaker=Toruk_Ghost
                            message= _ "Go. Let me enjoy this last sunset."
                        [/message]

                        [kill]
                            id=Toruk_Ghost
                            animate=no
                        [/kill]
                        [kill]
                            id=Arshag_Ghost
                            animate=no
                        [/kill]
                    [/else]
                [/if]
                {VARIABLE dream_sequence 4}
                [unstore_unit]
                    variable=arshag_store
                    find_vacant=yes
                [/unstore_unit]
                [fire_event]
                    name=door_opens
                [/fire_event]
            [/case]
            [case]
                value=2 #Orcish Fortress
                [terrain_mask]
                    x,y=19,2
                    alignment=raw
                    mask="_f, _f, _f, _f, _f, Rrc, _f, _f, _f, _f, _f, _f, _f
                    _f, _f, _f, Xoa^Efs, Ias^Eqf, Rrc, Ias^Eqf, Xoa^Efs, _f, _f, _f, _f, _f
                    _f, Ias^Eqf, Ias^Eqf, Ias, Ias, Rrc, Ias, Ias, Ias^Eqf, Ias^Eqf, _f, _f, _f
                    _f, Ias, Ias, Xoa^Efs, Ias, Rrc, Ias, Xoa^Efs, Ias, Ias, _f, _f, _f
                    _f, Ias^Eqf, Ias, Ias, Ias, Rrc, Ias, Ias, Ias, Ias^Eqf, _f, _f, _f
                    _f, _f, Ias^Eqf, Xoa^Efs, Ias, Rrc, Ias, Xoa^Efs, Ias^Eqf, _f, _f, _f, _f
                    _f, _f, _f, _f, Ias, Rrc, Ias, _f, _f, _f, _f, _f, _f"
                [/terrain_mask]
                [time_area]
                    id=thirddream_ta
                    {INDOORS}
                    x="20,21,22,23,24,25,26,27,28"
	                y="4-6,4-7,3-7,3-8,2-8,3-8,3-7,4-7,4-6"
                [/time_area]

                [unit]
                    side=1
                    type=RTL Orcish Shaman
                    id=Ghost_Vudhar
                    unrenamable=yes
                    name= _ "Vudhar"
                    profile=portraits/vudhar.webp
                    x,y=24,4
                    facing=sw
                    [modifications]
                        {TRAIT_LOYAL_HERO}
                        {TRAIT_IMAGINARY}
                        [object]
                            [effect]
                                apply_to=image_mod
                                add=~O(70%)~GS()~CS(-200,-40,-40)
                            [/effect]
                        [/object]
                    [/modifications]
                [/unit]

                [message]
                    speaker=Arshag_Ghost
                    message= _ "Mother!"
                [/message]

                {MOVE_UNIT id=Arshag_Ghost 23 5}
                [modify_unit]
                    [filter]
                        id=Arshag_Ghost
                    [/filter]
                    facing=ne
                [/modify_unit]
                {MOVE_UNIT id=Toruk_Ghost 25 5}
                [modify_unit]
                    [filter]
                        id=Toruk_Ghost
                    [/filter]
                    facing=nw
                [/modify_unit]

                [message]
                    speaker=Ghost_Vudhar
                    image="portraits/vudhar.webp~O(70%)~GS()~CS(-200,-40,-40)"
                    message= _ "Arshag! You've come so far..."
                [/message]

                [message]
                    speaker=Arshag_Ghost
                    message= _ "Is it really you? In all the other dreams my enemies insulted me and questioned my entire journey.
                    
Never in my life did I want your advice more."
                [/message]

                [message]
                    speaker=Ghost_Vudhar
                    image="portraits/vudhar.webp~O(70%)~GS()~CS(-200,-40,-40)"
                    message= _ "I won't give it."
                [/message]

                [message]
                    speaker=Ghost_Vudhar
                    image="portraits/vudhar.webp~O(70%)~GS()~CS(-200,-40,-40)"
                    message= _ "You don't need it and you've never needed it.

The blood of the shamans flows in your veins and guides you, my son. You make your own path."
                [/message]

                [message]
                    speaker=Arshag_Ghost
                    message= _ "But I don't even know if it's the right one!"
                [/message]

                [message]
                    speaker=Toruk_Ghost
                    message= _ "I do.
                    
All my life I've been running from danger, trying to survive day by day. I've watched the warlords kneel before Jevyan and sell our souls, and I thought there was no other way."
                [/message]

                [message]
                    speaker=Toruk_Ghost
                    message= _ "That we orcs could never be more than ravagers and slaves."
                [/message]

                [message]
                    speaker=Ghost_Vudhar
                    image="portraits/vudhar.webp~O(70%)~GS()~CS(-200,-40,-40)"
                    message= _ "What we have is something that most other creatures of this world lack.
                    
They live in their tiny minds, content with sorting everything they encounter into chests and bags. They think they are wise, but they blindfold themselves."
                [/message]

                [message]
                    speaker=Ghost_Vudhar
                    image="portraits/vudhar.webp~O(70%)~GS()~CS(-200,-40,-40)"
                    message= _ "Become one with the rock and your enemies will not move you.
Become one with the wind and their nets will not catch you.
Become one with the fire and you will burn them to ashes.
Become one with the water, let it all go and the world itself will show you the way."
                [/message]
                [message]
                    speaker=Ghost_Vudhar
                    image="portraits/vudhar.webp~O(70%)~GS()~CS(-200,-40,-40)"
                    message= _ "Goodbye, Arshag."
                [/message]
                [kill]
                    id=Ghost_Vudhar
                    animate=no
                [/kill]
                [kill]
                    id=Toruk_Ghost
                    animate=no
                [/kill]
                [kill]
                    id=Arshag_Ghost
                    animate=no
                [/kill]
                {VARIABLE dream_sequence 4}
                [unstore_unit]
                    variable=arshag_store
                    find_vacant=yes
                [/unstore_unit]
                [unstore_unit]
                    variable=toruk_store
                    find_vacant=yes
                [/unstore_unit]
                [fire_event]
                    name=door_opens
                [/fire_event]
            [/case]
        [/switch]
    [/event]

    [event]
        name=morv_enc

        {MOVE_UNIT id=Arshag_Ghost 21 22}
        {MOVE_UNIT id=Toruk_Ghost 22 22}
        {GHOST_LEADER "Lieutenant" 22 21 "Ghost_Morvin" "Morvin"}

        [modify_unit]
            [filter]
                id=Arshag_Ghost
            [/filter]
            facing=ne
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Toruk_Ghost
            [/filter]
            facing=nw
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Ghost_Morvin
            [/filter]
            facing=sw
        [/modify_unit]

        [message]
            speaker=Arshag_Ghost
            message= _ "You?! What are you doing here?"
        [/message]

        [message]
            speaker=Ghost_Morvin
            image="portraits/humans/lieutenant.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "The search isn't going too well, is it?

You still can't find a place where your horde can multiply and regain the strength to infest the entire continent."
        [/message]

        [if]
            [variable]
                name=morvin_dead
                equals=yes
            [/variable]
            [then]
                [message]
                    speaker=Arshag_Ghost
                    message= _ "I regret I can't kill you the second time for this."
                [/message]
                {CLEAR_VARIABLE morvin_dead}
            [/then]
            [else]
                [message]
                    speaker=Arshag_Ghost
                    message= _ "I knew I should have cut your head off while I had the chance."
                [/message]
            [/else]
        [/if]  

        [message]
            speaker=Ghost_Morvin
            image="portraits/humans/lieutenant.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "Well, it's in your nature. That's also why you'll fail."
        [/message]

        [message]
            speaker=Ghost_Morvin
            image="portraits/humans/lieutenant.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "We humans serve that which transcends us.

The Kingdom of Wesnoth is an ideal, a dream of what can be again for all of us who went through the destruction of Green Island. You orcs have nothing of the sort."
        [/message]

        [kill]
            id=Ghost_Morvin
            animate=no
        [/kill]

        [if]
            [have_unit]
                id=Toruk_Ghost
            [/have_unit]
            [then]
                [message]
                    speaker=Arshag_Ghost
                    message= _ "Do you think that it's true, Toruk?"
                [/message]
        
                [delay]
                    time=500
                [/delay]
        
                [message]
                    speaker=Toruk_Ghost
                    message= _ "I don't know, Arshag.

Maybe the shamans had that, but their secrets died with Vudhar."
                [/message]

                [message]
                    speaker=Toruk_Ghost
                    message= _ "We never should have left our old home."
                [/message]
            [/then]
        [/if]  

        {TELEPORT_UNIT (id=Arshag_Ghost) 23 17}
        {TELEPORT_UNIT (id=Toruk_Ghost) 25 17}
        [fire_event]
            name=second_encounter
        [/fire_event]
    [/event]

    [event]
        name=birm_enc

        {CLEAR_VARIABLE morvin_dead} #won't be used in this branch

        {MOVE_UNIT id=Arshag_Ghost 20 20}
        {MOVE_UNIT id=Toruk_Ghost 21 21}
        {GHOST_LEADER "Dwarvish Sentinel" 21 20 "Ghost_Birmaglost" "Birmaglost"}  
        [modify_unit]
            [filter]
                id=Arshag_Ghost
            [/filter]
            facing=ne
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Toruk_Ghost
            [/filter]
            facing=nw
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Ghost_Birmaglost
            [/filter]
            facing=sw
        [/modify_unit]
        
        [message]
            speaker=Arshag_Ghost
            message= _ "You?! What are you doing here?"
        [/message]

        [message]
            speaker=Ghost_Birmaglost
            image="portraits/dwarves/sentinel.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "I've come tae give ye a warning, ye daft fool. I ken all too well how yer journey will come tae an end."
        [/message]

        [message]
            speaker=Arshag_Ghost
            message= _ "Wh- what do you mean by that?"
        [/message]

        [message]
            speaker=Ghost_Birmaglost
            image="portraits/dwarves/sentinel.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "Yer usefulness is passing. They look at ye as naught but a practical tool, a weapon, but one that can cut both ways.

I, too, was once of value to Oddogard, so long as I slaughtered elves, his foes. When times of peace arrived, my warrior spirit nae longer pleased him."
        [/message]

        [kill]
            id=Ghost_Birmaglost
            animate=no
        [/kill]

        [if]
            [have_unit]
                id=Toruk_Ghost
            [/have_unit]
            [then]
                [message]
                    speaker=Arshag_Ghost
                    message= _ "Do you think that it's true, Toruk?"
                [/message]
        
                [delay]
                    time=500
                [/delay]
        
                [message]
                    speaker=Toruk_Ghost
                    message= _ "I don't know, Arshag.

Every time I think I'm starting to understand this continent, it surprises me again."
                [/message]

                [message]
                    speaker=Toruk_Ghost
                    message= _ "I miss our old home."
                [/message]
            [/then]
        [/if]  

        {TELEPORT_UNIT (id=Arshag_Ghost) 23 17}
        {TELEPORT_UNIT (id=Toruk_Ghost) 25 17}
        [fire_event]
            name=second_encounter
        [/fire_event]
    [/event]

    [event]
        name=orc_enc

        {MOVE_UNIT id=Arshag_Ghost 21 22}
        {MOVE_UNIT id=Toruk_Ghost 22 21}
        {GHOST_LEADER "Orcish Warlord" 20 21 "Ghost_Vragish" "Tan-Vragish"}
        {GHOST_LEADER "Orcish Warlord" 22 20 "Ghost_Prodash" "Tan-Prodash"}
        {GHOST_LEADER "Orcish Warlord" 22 22 "Ghost_Grorag" "Ut'Tan-Grorag"}
        [modify_unit]
            [filter]
                id=Arshag_Ghost
            [/filter]
            facing=ne
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Toruk_Ghost
            [/filter]
            facing=se
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Ghost_Vragish
            [/filter]
            facing=ne
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Ghost_Prodash
            [/filter]
            facing=sw
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Ghost_Grorag
            [/filter]
            facing=ne
        [/modify_unit]

        [message]
            speaker=Arshag_Ghost
            message= _ "You three! It's all your fault! If not for you, we would never go through the Lich's portal to this cursed new world!"
        [/message]

        [message]
            speaker=Ghost_Grorag
            image="portraits/orcs/warlord.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "How would you know, pup? We did what we had to!"
        [/message]

        [message]
            speaker=Ghost_Vragish
            image="portraits/orcs/warlord.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "Our old lands couldn't support us. There wasn't enough food for all. We kept on fighting each other all the time."
        [/message]

        [if]
            [have_unit]
                id=Toruk_Ghost
            [/have_unit]
            [then]      
                [message]
                    speaker=Toruk_Ghost
                    message= _ "And so you started licking the soles of that bag of bones, Jevyan.
                    
Apparently it worked, considering you're all dead now."
                [/message]
                [message]
                    speaker=Ghost_Prodash
                    image="portraits/orcs/warlord.webp~O(70%)~GS()~CS(-200,-40,-40)"
                    message= _ "You got the nerve to speak up? If it weren't for cowards like you, I'd be drinking from that brat Haldric's skull today."
                [/message]
                [message]
                    speaker=Ghost_Grorag
                    image="portraits/orcs/warlord.webp~O(70%)~GS()~CS(-200,-40,-40)"
                    message= _ "Listen up, assassin.

If you gather those kinds of companions around you, it'll turn out real bad, just like it did for us."
                [/message]
                [message]
                    speaker=Toruk_Ghost
                    message= _ "I've had enough!"
                [/message]
                [animate_unit]
                    flag=attack
                    [filter]
                        id=Toruk_Ghost
                    [/filter]
                    [facing]
                        x,y=22,22
                    [/facing]
                    [primary_attack]
                        range=melee
                    [/primary_attack]
                    hits=yes
                    [animate]
                        flag=defend
                        [filter]
                            x,y=22,22
                        [/filter]
                        hits=no
                    [/animate]
                [/animate_unit]
                [message]
                    speaker=Ghost_Grorag
                    image="portraits/orcs/warlord.webp~O(70%)~GS()~CS(-200,-40,-40)"
                    message= _ "Ha ha ha ha ha! You've always been weak."
                [/message]
                [animate_unit]
                    flag=attack
                    [filter]
                        id=Ghost_Grorag
                    [/filter]
                    [facing]
                        x,y=22,21
                    [/facing]
                    [primary_attack]
                        range=melee
                    [/primary_attack]
                    hits=yes
                    [animate]
                        flag=defend
                        [filter]
                            x,y=22,21
                        [/filter]
                        hits=yes
                    [/animate]
                [/animate_unit]
                [message]
                    speaker=Arshag_Ghost
                    message= _ "Toruk!"
                [/message]
                [kill]
                    canrecruit=yes
                    side=5
                    animate=no
                [/kill]
                [message]
                    speaker=Toruk_Ghost
                    message= _ "I'm... fine.

Let's continue."
                [/message]
            [/then]
            [else]
                [message]
                    speaker=Ghost_Prodash
                    image="portraits/orcs/warlord.webp~O(70%)~GS()~CS(-200,-40,-40)"
                    message= _ "You feel it inside, don't you?

You can't win where we, the mightiest orcish warlords, couldn't."
                [/message]
                [message]
                    speaker=Arshag_Ghost
                    message= _ "I know better than to charge head first into battles I can't win."
                [/message]
                [message]
                    speaker=Ghost_Grorag
                    image="portraits/orcs/warlord.webp~O(70%)~GS()~CS(-200,-40,-40)"
                    message= _ "When you're cornered, you'll learn that too."
                [/message]
                [kill]
                    canrecruit=yes
                    side=5
                    animate=no
                [/kill]
            [/else]
        [/if]  

        {TELEPORT_UNIT (id=Arshag_Ghost) 23 17}
        {TELEPORT_UNIT (id=Toruk_Ghost) 25 17}
        [fire_event]
            name=second_encounter
        [/fire_event]
    [/event]

    [event]
        name=loga_enc

        {MOVE_UNIT id=Arshag_Ghost 23 13}
        {MOVE_UNIT id=Toruk_Ghost 24 13}
        {GHOST_LEADER "Elvish Champion Kalian" 24 12 "Ghost_Logalmier" "Lord Logalmier"}
        [modify_unit]
            [filter]
                id=Arshag_Ghost
            [/filter]
            facing=ne
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Toruk_Ghost
            [/filter]
            facing=ne
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Ghost_Logalmier
            [/filter]
            facing=sw
        [/modify_unit]

        [message]
            speaker=Ghost_Logalmier
            image="portraits/logalmier.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "So we meet again."
        [/message]

        [message]
            speaker=Arshag_Ghost
            message= _ "Will you ever stop hunting us? Can't you just leave us be?"
        [/message]

        [message]
            speaker=Ghost_Logalmier
            image="portraits/logalmier.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "I cannot.

Doing so would risk the future of my own kin. It is inevitable that our races will come into conflict. I'm just willing to get my hands dirty so my descendants never have to."
        [/message]

        [message]
            speaker=Arshag_Ghost
            message= _ "How very considerate of you."
        [/message]

        [message]
            speaker=Ghost_Logalmier
            image="portraits/logalmier.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "Don't mock me. Your time is running out.

I sent a mutual friend on your trail. Perhaps she can convince you that your efforts are futile."
        [/message]

        [kill]
            id=Ghost_Logalmier 
            animate=no
        [/kill]

        {TELEPORT_UNIT (id=Arshag_Ghost) 23 8}
        {TELEPORT_UNIT (id=Toruk_Ghost) 25 8}
        [fire_event]
            name=third_encounter
        [/fire_event]
    [/event]

    [event]
        name=zofa_enc

        {MOVE_UNIT id=Arshag_Ghost 23 13}
        {MOVE_UNIT id=Toruk_Ghost 24 13}
        {GHOST_LEADER "Elvish Enchantress" 24 12 "Ghost_Zofaria" "Zofaria"}
        [modify_unit]
            [filter]
                id=Arshag_Ghost
            [/filter]
            facing=ne
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Toruk_Ghost
            [/filter]
            facing=ne
        [/modify_unit]
        [modify_unit]
            [filter]
                id=Ghost_Zofaria
            [/filter]
            facing=sw
        [/modify_unit]

        [message]
            speaker=Arshag_Ghost
            message= _ "It's you, Logalmier's sorceress! I've seen you during our negotiations.

I'm sure it was you who put the curse on the dead."
        [/message]

        [message]
            speaker=Ghost_Zofaria
            image="portraits/elves/sorceress.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "I did.
            
And do not look at me like that. You should understand how the world works by now."
        [/message]

        [message]
            speaker=Ghost_Zofaria
            image="portraits/elves/sorceress.webp~O(70%)~GS()~CS(-200,-40,-40)"
            message= _ "There are just the lords and the subjects, the masters and the slaves, the puppeteers and the puppets. Power is power, whether it comes from light or darkness.

You orcs were always just puppets, and bad ones at that. Without your threads, you just flap around and destroy everything you touch."
        [/message]

        [kill]
            id=Ghost_Zofaria
            animate=no
        [/kill]

        {TELEPORT_UNIT (id=Arshag_Ghost) 23 8}
        {TELEPORT_UNIT (id=Toruk_Ghost) 25 8}
        [fire_event]
            name=third_encounter
        [/fire_event]
    [/event]

    [event] #easter egg: the ghost can enter the dream sequence
        name=moveto

        [filter]
            type_adv_tree=Ghost
            side=1
            x="14,14,15,16,16,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31"
			y="17,23-25,13-25,0-4,8-9,12-24,0-24,0-23,0-24,0-23,0-24,0-24,0-24,0-23,0-23,0-23,0-24,0-24,0-25,0-23,0-23"
        [/filter]

        [filter_condition]
            [variable]
                name=dream_sequence
                greater_than=1
            [/variable]
        [/filter_condition]


        [terrain]
            terrain="Qxua^Xo"
            x="14,15,16,17,18,19,20,21,22,23,24,25,26,27,28"
	        y="26,26,25,25,24,25,24,25,25,25,24,24,24,25,25"
        [/terrain]

        [modify_unit]
            [filter]
                type_adv_tree=Ghost
                side=1
                x="14,14,15,16,16,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31"
			    y="17,23-25,13-25,0-4,8-9,12-24,0-24,0-23,0-24,0-23,0-24,0-24,0-24,0-23,0-23,0-23,0-24,0-24,0-25,0-23,0-23"
            [/filter]
            [object]
                [effect]
                    apply_to=image_mod
                    add=~O(70%)~GS()~CS(-200,-40,0)
                [/effect]
                [effect]
                    apply_to=attack
                    range=melee
                    [set_specials]
                        mode=replace
                        {WEAPON_SPECIAL_LUCIDITY}
                    [/set_specials]
                [/effect]
                [effect]
                    apply_to=attack
                    range=ranged
                    set_type=arcane
                    [set_specials]
                        mode=replace
                        {WEAPON_SPECIAL_LUCIDITY}
                    [/set_specials]
                [/effect]
                [effect]
                    apply_to=remove_advancement
                    amlas=amla_default
                [/effect]
            [/object]
        [/modify_unit]

        [store_unit]
            [filter] 
                type_adv_tree=Ghost
                side=1
                x="14,14,15,16,16,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31"
			    y="17,23-25,13-25,0-4,8-9,12-24,0-24,0-23,0-24,0-23,0-24,0-24,0-24,0-23,0-23,0-23,0-24,0-24,0-25,0-23,0-23"
            [/filter]
            variable=ghost_xp_unit
        [/store_unit]

        {VARIABLE ghost_xp_unit.advances_to null}

        [unstore_unit]
            variable=ghost_xp_unit
        [/unstore_unit]

        {CLEAR_VARIABLE ghost_xp_unit}
    [/event]

    [event] #stop saurian spawns as the player approaches the gate
        name=moveto

        [filter]
            side=1
            x="1,2,3,4,5,6,7,8,9,9,10,11,11,12,12,13,14"
	        y="7-9,5-9,3-16,2-16,2-17,2-16,2-17,2-16,2-5,7-17,1-17,2-10,12-17,2-9,14-16,3-9,3-6"
        [/filter]

        {VARIABLE stop_saurians yes}

    [/event]

    [event] #Stuurg can save dream versions of Arshag & Toruk once, if he's inside the fortress
        name=last breath

        [filter]
            id=Arshag_Ghost,Toruk_Ghost
        [/filter]

        [filter_condition]
            [have_unit]
                id=Stuurg
                x="25,25,26,26,27,28"
                y="27,30,27,29,27-30,28"
            [/have_unit]
        [/filter_condition]

        [message]
            speaker=unit
            message= _ "I'm fading away!"
        [/message]

        [message]
            speaker=Stuurg
            message= _ "He's dying! I have to concentrate."
        [/message]

        [modify_unit]
            [filter]
                id=Stuurg
            [/filter]
                [object]
                    id=stuurg_temp_leading
                    [effect]
                        apply_to=new_animation
                        [leading_anim]
                            start_time=-150
                            [frame]
                                image="units/trolls/rtl-shaman-ranged.png:300"
                                sound=magicmissile.wav
                            [/frame]
                        [/leading_anim]
                    [/effect]
                [/object]
        [/modify_unit]

        [animate_unit]
            [filter]
                id=Stuurg
            [/filter]
            flag=leading
        [/animate_unit]

        [remove_object]
            object_id=stuurg_temp_leading
        [/remove_object]

        [animate_unit]
            [filter]
                id=$unit.id
            [/filter]
            flag=healed
            text=10
            green=255
        [/animate_unit]

        {VARIABLE unit.hitpoints 10}

        [unstore_unit]
            variable=unit
        [/unstore_unit]

        [message]
            speaker=Stuurg
            message= _ "That's all I can do. You're on your own now."
        [/message]

        {VARIABLE stuurg_heal_used yes}

    [/event]

    [event]
        name=door_opens

        [modify_unit]
            [filter]
                id=Arshag,Toruk
            [/filter]
            [effect]
                apply_to=hitpoints
                heal_full=yes
            [/effect]
        [/modify_unit]

        {CLEAR_VARIABLE arshag_store}

        [scroll_to]
            x,y=6,1
        [/scroll_to]

        [sound]
            name=open-chest.wav
        [/sound]

        [modify_unit]
            [filter]
                id=Stuurg
            [/filter]
            canrecruit=no
            {TRAIT_LOYAL_HERO}
        [/modify_unit]

        {MODIFY_TERRAIN Rr^Pw|o 6 1}

        [delay]
            time=500
        [/delay]

        {IF_TORUK Stuurg "You're back!" "You're back! But why's Toruk not waking up?"}

        {IF_TORUK Arshag "We are, but what I've seen worries me. Let's push forward as fast as we can." "He's... gone."}

        {DEAD_TORUK Stuurg "Arshag, what happened?!"}

        {DEAD_TORUK Arshag "I don't want to talk about it now. Let's push forward, far from this cursed place."}

        [if]
            [have_unit]
                id=Toruk
            [/have_unit]
            [and]
                [have_unit]
                    type_adv_tree=Ghost
                    side=1
                    x="14,14,15,16,16,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31"
			        y="17,23-25,13-25,0-4,8-9,12-24,0-24,0-23,0-24,0-23,0-24,0-24,0-24,0-23,0-23,0-23,0-24,0-24,0-25,0-23,0-23"
                [/have_unit]
            [/and]
            [then]
                [message]
                    type_adv_tree=Ghost
                    side=1
                    x="14,14,15,16,16,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31"
			        y="17,23-25,13-25,0-4,8-9,12-24,0-24,0-23,0-24,0-23,0-24,0-24,0-24,0-23,0-23,0-23,0-24,0-24,0-25,0-23,0-23"
                    message= _ "I will stay in this land of dreams. Here I can finally find peace."
                [/message]
                [kill]
                    type_adv_tree=Ghost
                    side=1
                    x="14,14,15,16,16,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31"
			        y="17,23-25,13-25,0-4,8-9,12-24,0-24,0-23,0-24,0-23,0-24,0-24,0-24,0-23,0-23,0-23,0-24,0-24,0-25,0-23,0-23"
                [/kill]
            [/then]
            [elseif]
                [have_unit]
                    type_adv_tree=Ghost
                    side=1
                    x="14,14,15,16,16,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31"
			        y="17,23-25,13-25,0-4,8-9,12-24,0-24,0-23,0-24,0-23,0-24,0-24,0-24,0-23,0-23,0-23,0-24,0-24,0-25,0-23,0-23"
                [/have_unit]
                [then]
                    [message]
                        speaker=Stuurg
                        message= _ "What about the ghost?"
                    [/message]
                    [message]
                        type_adv_tree=Ghost
                        side=1
                        x="14,14,15,16,16,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31"
			            y="17,23-25,13-25,0-4,8-9,12-24,0-24,0-23,0-24,0-23,0-24,0-24,0-24,0-23,0-23,0-23,0-24,0-24,0-25,0-23,0-23"
                        message= _ "I feel a freshly deceased body! This is my chance to get out of this unlife!"
                    [/message]
                    [kill]
                        type_adv_tree=Ghost
                        side=1
                        x="14,14,15,16,16,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31"
			            y="17,23-25,13-25,0-4,8-9,12-24,0-24,0-23,0-24,0-23,0-24,0-24,0-24,0-23,0-23,0-23,0-24,0-24,0-25,0-23,0-23"
                    [/kill]
                    [unit]
                        type=$toruk_store.type
                        id=Not_Toruk
                        x=$toruk_store.x
                        y=$toruk_store.y
                        name=The reborn orc
                        side=1
                    [/unit]
                    [modify_unit]
                        [filter]
                            id=Not_Toruk
                        [/filter]
                        [effect]
                            apply_to=remove_ability
                            [experimental_filter_ability] #todo: experimental feature, prone to change
                                id=rtl_heartens
                            [/experimental_filter_ability]
                        [/effect]
                    [/modify_unit]
                    [message]
                        speaker=Arshag
                        message= _ "I think Toruk just opened his eyes!"
                    [/message]
                    [message]
                        speaker=Stuurg
                        message= _ "I'm sorry, Arshag. It's not Toruk."
                    [/message]
                    [message]
                        speaker=Not_Toruk
                        message= _ "I couldn't resist the lure of the world of the living, chief."
                    [/message]
                    [set_achievement]
                        content_for=RTL_SP
                        id=RTL_servitude
                    [/set_achievement]
                [/then]
            [/elseif]
        [/if]

        [remove_time_area]
            id=firstdream_ta,seconddream_ta,thirddream_ta
        [/remove_time_area]

        [terrain]
            terrain=Qxua
            x="16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,30"
	        y="14-20,13-23,2-23,2-24,1-23,1-24,1-24,1-24,1-23,1-23,1-23,1-24,1-23,2-23,5-11,16-18"
        [/terrain]

        [if] #Toruk's soul
            [have_unit]
                id=Toruk
            [/have_unit]
            [then]
            [/then]
            [else]
                {MODIFY_TERRAIN Qxua^Efs 22 24}
            [/else]
        [/if]

        [show_objectives]
        [/show_objectives]

    [/event]

    [event] #unit spots a fish with arms
        name=moveto
        [filter]
            x,y=3,30
            side=1
        [/filter]
        [filter_condition]
            [variable]
                name=fish_spotted
                not_equals=yes
            [/variable]
        [/filter_condition]
        {VARIABLE fish_spotted yes}
        [move_unit_fake]
            type=Hunter Caribe
            side=3
            x=5,4
            y=28,31
        [/move_unit_fake]
        [if]
            [have_unit]
                id=Gaethyn
                x,y=3,30
            [/have_unit]
            [and]
                [variable]
                    name=gaethyn_discovered
                    equals=yes
                [/variable]
            [/and]
            [then]
                {VARIABLE gaethyn_discovered river}
                [fire_event]
                    name=fish_river
                [/fire_event]
            [/then]
            [else]
                [if]
                    [have_unit]
                        id=Gaethyn
                        search_recall_list=yes
                    [/have_unit]
                    [then]
                        {VARIANT_SAY "Huh, fishes with arms? Dat will make da dead guy happy." "I sssee sssomething like a fisssh with armsss. Isss it the creature that Gaethyn keepsss talking about?" "That fish had arms! Get the dead fisher!" "I swear that fish had arms! Call the undead fisherman!"}
                        [recall]
                            id=Gaethyn
                            x,y=26,28
                        [/recall]
                        [message]
                            speaker=Gaethyn
                            message= _ "My fish? Where?!"
                        [/message]
                    [/then]
                    [else]
                        {VARIANT_SAY "Huh, fishes with arms?" "The water here isss cold and dark. I sssee sssome weird creaturesss near the bottom. They look like a fisssh, but have armsss!" "That fish had arms! Get the dead fisher!" "There are some strange fish in this lake. I swear I saw one that has hands!"}
                    [/else]
                [/if]
            [/else]
        [/if]
    [/event]

    [event] #in case Gaethyn comes only after he's called
        name=moveto
        [filter]
            x,y=3,30
            id=Gaethyn
        [/filter]
        {VARIABLE gaethyn_discovered river}
        {VARIABLE fish_spotted yes}
        [fire_event]
            name=fish_river
        [/fire_event]
    [/event]

    [event]
        name=fish_river
        [message]
            speaker=Gaethyn
            message= _ "Oh, there it is!
The fish with arms!
The one that I've been so long searching for!"
        [/message]

#ifdef EASY
        {GENERIC_UNIT 3 (Nibbler) 5 29}
        {GENERIC_UNIT 3 (Nibbler) 5 31}
#endif
#ifdef NORMAL
        {GENERIC_UNIT 3 (Nibbler) 5 29}
        {GENERIC_UNIT 3 (Caribe) 5 31}
#endif
#ifdef HARD
        {GENERIC_UNIT 3 (Caribe) 5 29}
        {GENERIC_UNIT 3 (Caribe) 5 31}
#endif
        [unit]
            side=3
            id=The Fish
            type=Hunter Caribe
            x,y=3,31
            facing=ne
            [modifications]
                {TRAIT_LOYAL_HERO}
            [/modifications]
        [/unit]

        [message]
            speaker=Gaethyn
            message= _ "Everyone, stay back!

I'm going to be really angry if someone else catches that fish first."
        [/message]
    [/event]

    [event]
        name=moveto

        [filter]
            x,y=6,1
            side=1
        [/filter]

        [message]
            speaker=Stuurg
            message= _ "We have reached the gate!"
        [/message]

        [message]
            speaker=Toruk
            message= _ "Great! I can't wait to feel wind on my face again."
        [/message]

        {IF_TORUK Arshag "I just hope we have escaped Logalmier's wrath for good." "For what cost? Toruk's dead and with him many of our best warriors..."}

        [remove_object]
            race=troll
            object_id=troll_purple
        [/remove_object]
        [message]
            id=Stuurg
            message= _ "You led us well in the depths.

The trolls made a good choice."
        [/message]

        {CLEAR_VARIABLE stop_saurians}
        {CLEAR_VARIABLE dream_sequence}
        {CLEAR_VARIABLE fortress_visited}
        {CLEAR_VARIABLE stuurg_heal_used}
        {CLEAR_VARIABLE ghost_xp_unit}
        {CLEAR_VARIABLE fish_spotted}
        {CLEAR_VARIABLE gaethyn_discovered}
        {CLEAR_VARIABLE toruk_store}
        {CLEAR_VARIABLE braziers_count}
        {CLEAR_VARIABLE trolling}

        [endlevel]
            result=victory
            bonus=no
            {NEW_GOLD_CARRYOVER 0}
        [/endlevel]
    [/event]

    [event]
        name=time over
        [message]
            race=orc #maybe Arshag and Toruk are ghosts at the moment
            message= _ "We ate the last of the supplies.

We can't feed on mushrooms like trolls..."
        [/message]
    [/event]

    [event] #the undead are turned away by the fortress
        name=enter_hex
        first_time_only=no
        [cancel_action]
        [/cancel_action]
        [filter]
            side=4
            x="11,12,13,14,15"
	        y="34-35,32-35,32-35,32-34,33-34"
        [/filter]
        [modify_unit]
            [filter]
                side=4
                x="11,12,13,14,15"
	            y="34-35,32-35,32-35,32-34,33-34"
            [/filter]
            role=turnedundead
            moves=0
        [/modify_unit]
        [micro_ai]
            side=4
            ai_type=zone_guardian
            action=add
            [filter]
                role=turnedundead
            [/filter]
            [filter_location]
                x=1
                y=43
            [/filter_location]
        [/micro_ai]
    [/event]

    [event]
        name=moveto
        first_time_only=no
        [filter]
            role=turnedundead
            x,y=1,43
        [/filter]
        [kill]
            id=$unit.id
            animate=no
        [/kill]
    [/event]

[/scenario]
